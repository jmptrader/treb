/*! v13.0.2. Copyright 2018-2021 Structured Data, LLC. All rights reserved. CC BY-ND: https://treb.app/license */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["treb-format-lib"]=e():t["treb-format-lib"]=e()}(this,(function(){return(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Hints:()=>g,Localization:()=>d,LotusDate:()=>x,NumberFormat:()=>C,NumberFormatCache:()=>S,NumberFormatSection:()=>i,UnlotusDate:()=>b,ValueParser:()=>M});var r,n,i=function(){this.date_format=!1,this.string_format=!1,this.fraction_format=!1,this.twelve_hour=!1,this.fraction_denominator=0,this.fraction_integer=!0,this.fraction_align=0,this.fraction_denominator_digits=0,this.integer_min_digits=0,this.decimal_min_digits=0,this.decimal_max_digits=0,this.grouping=!1,this.has_number_format=!1,this.prefix=[{text:""}],this.suffix=[{text:""}],this.scaling=0,this.percent=!1,this.exponential=!1,this.has_asterisk=!1},o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},a=function(){function t(t,e,r){void 0===e&&(e=t),void 0===r&&(r=!1),this.end_=this.PatchNull(e),this.start_=this.PatchNull(t),r&&this.Normalize()}return t.FromColumn=function(e){return new t({row:1/0,column:e})},t.FromRow=function(e){return new t({row:e,column:1/0})},t.ColumnToLabel=function(t){for(var e=String.fromCharCode(65+t%26);t>25;)t=Math.floor(t/26)-1,e=String.fromCharCode(65+t%26)+e;return e},t.CellAddressToLabel=function(t,e){return void 0===e&&(e=!1),(e?(t.sheet_id||0)+"!":"")+(t.absolute_column?"$":"")+this.ColumnToLabel(t.column)+(t.absolute_row?"$":"")+(t.row+1)},t.Join=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];for(var i=new t(e.start,e.end),o=0,a=r;o<a.length;o++){var s=a[o];s&&(i.ConsumeAddress(s.start),i.ConsumeAddress(s.end))}return i},t.Bleed=function(e,r){return void 0===r&&(r=1),new t({row:Math.max(0,e.start.row-r),column:Math.max(0,e.start.column-r)},{row:e.end.row+r,column:e.end.column+r})},Object.defineProperty(t.prototype,"start",{get:function(){return o({},this.start_)},set:function(t){this.start_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return o({},this.end_)},set:function(t){this.end_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this.start_.row===1/0||this.end_.row===1/0?1/0:this.end_.row-this.start_.row+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.start_.column===1/0||this.end_.column===1/0?1/0:this.end_.column-this.start_.column+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.rows*this.columns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_sheet",{get:function(){return this.entire_row&&this.entire_column},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_column",{get:function(){return this.start_.row===1/0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_row",{get:function(){return this.start_.column===1/0},enumerable:!1,configurable:!0}),t.prototype.PatchNull=function(t){var e=o({},t);return null===e.row&&(e.row=1/0),null===e.column&&(e.column=1/0),e},t.prototype.SetSheetID=function(t){this.start_.sheet_id=t},t.prototype.Normalize=function(){var t=o({},this.start_),e=o({},this.end_);t.row===1/0||e.row===1/0?t.row=e.row=1/0:t.row>e.row&&(t.row=this.end_.row,t.absolute_row=this.end_.absolute_row,e.row=this.start_.row,e.absolute_row=this.start_.absolute_row),t.column===1/0||e.column===1/0?t.column=e.column=1/0:t.column>e.column&&(t.column=this.end_.column,t.absolute_column=this.end_.absolute_column,e.column=this.start_.column,e.absolute_column=this.start_.absolute_column),this.start_=t,this.end_=e},t.prototype.TopLeft=function(){var t={row:0,column:0};return this.entire_row||(t.column=this.start.column),this.entire_column||(t.row=this.start.row),t},t.prototype.BottomRight=function(){var t={row:0,column:0};return this.entire_row||(t.column=this.end.column),this.entire_column||(t.row=this.end.row),t},t.prototype.ContainsRow=function(t){return this.entire_column||t>=this.start_.row&&t<=this.end_.row},t.prototype.ContainsColumn=function(t){return this.entire_row||t>=this.start_.column&&t<=this.end_.column},t.prototype.Contains=function(t){return(this.entire_column||t.row>=this.start_.row&&t.row<=this.end_.row)&&(this.entire_row||t.column>=this.start_.column&&t.column<=this.end_.column)},t.prototype.ContainsArea=function(t){return this.start.column<=t.start.column&&this.end.column>=t.end.column&&this.start.row<=t.start.row&&this.end.row>=t.end.row},t.prototype.Intersects=function(t){return!(t.start.column>this.end.column||this.start.column>t.end.column||t.start.row>this.end.row||this.start.row>t.end.row)},t.prototype.Equals=function(t){return t.start_.row===this.start_.row&&t.start_.column===this.start_.column&&t.end_.row===this.end_.row&&t.end_.column===this.end_.column},t.prototype.Clone=function(){return new t(this.start,this.end)},t.prototype.Array=function(){if(this.entire_column||this.entire_row)throw new Error("can't convert infinite area to array");for(var t=new Array(this.rows*this.columns),e=this.start_.sheet_id,r=0,n=this.start_.row;n<=this.end_.row;n++)for(var i=this.start_.column;i<=this.end_.column;i++)t[r++]={row:n,column:i,sheet_id:e};return t},Object.defineProperty(t.prototype,"left",{get:function(){var e=new t(this.start_,this.end_);return e.end_.column=e.start_.column,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){var e=new t(this.start_,this.end_);return e.start_.column=e.end_.column,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){var e=new t(this.start_,this.end_);return e.end_.row=e.start_.row,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){var e=new t(this.start_,this.end_);return e.start_.row=e.end_.row,e},enumerable:!1,configurable:!0}),t.prototype.Shift=function(t,e){return this.start_.row+=t,this.start_.column+=e,this.end_.row+=t,this.end_.column+=e,this},t.prototype.ConsumeAddress=function(t){this.entire_row||(t.column<this.start_.column&&(this.start_.column=t.column),t.column>this.end_.column&&(this.end_.column=t.column)),this.entire_column||(t.row<this.start_.row&&(this.start_.row=t.row),t.row>this.end_.row&&(this.end_.row=t.row))},t.prototype.ConsumeArea=function(t){this.ConsumeAddress(t.start),this.ConsumeAddress(t.end)},t.prototype.Resize=function(t,e){return this.end_.row=this.start_.row+t-1,this.end_.column=this.start_.column+e-1,this},t.prototype.Iterate=function(t){if(this.entire_column||this.entire_row)console.warn("don't iterate infinite area");else for(var e=this.start_.column;e<=this.end_.column;e++)for(var r=this.start_.row;r<=this.end_.row;r++)t({column:e,row:r,sheet_id:this.start_.sheet_id})},Object.defineProperty(t.prototype,"spreadsheet_label",{get:function(){var e;return this.entire_sheet?"":this.entire_column?(e=t.ColumnToLabel(this.start_.column),e+=":"+t.ColumnToLabel(this.end_.column)):this.entire_row?(e=String(this.start_.row+1),e+=":"+(this.end_.row+1)):(e=t.CellAddressToLabel(this.start_),this.columns>1||this.rows>1?e+":"+t.CellAddressToLabel(this.end_):e)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{start:o({},this.start_),end:o({},this.end_)}},t}();(n=r||(r={}))[n[void 0]=0]="undefined",n[n.formula=1]="formula",n[n.string=2]="string",n[n.number=3]="number",n[n.boolean=4]="boolean",n[n.object=5]="object",n[n.error=6]="error",n[n.complex=7]="complex",n[n.array=8]="array";var s,h=function(t){switch(typeof t){case"undefined":return r.undefined;case"number":return r.number;case"boolean":return r.boolean;case"object":return null===t?r.undefined:function(t){return"object"==typeof t&&!!t&&"number"==typeof t.real&&"number"==typeof t.imaginary}(t)?r.complex:r.object;case"string":return"="===t[0]?r.formula:r.string;default:return r.error}};!function(t){t[t.List=0]="List",t[t.Date=1]="Date",t[t.Range=2]="Range",t[t.Number=3]="Number",t[t.Boolean=4]="Boolean"}(s||(s={}));var c=function(){function t(t,e){this.type=r.undefined,this.render_dirty=!0,void 0!==t&&this.Set(t,e)}return t.StringToColumn=function(t){var e=0;t=t.toUpperCase();for(var r=0;r<t.length;r++)e*=26,e+=t.charCodeAt(r)-64;return e-1},t.prototype.ValueIsNumber=function(){return this.type===r.number},t.prototype.ValueIsFormula=function(){return this.type===r.formula},t.prototype.ValueIsBoolean=function(){return this.type===r.boolean},t.prototype.ValueIsComplex=function(){return this.type===r.complex},t.prototype.FlushStyle=function(){this.formatted=this.rendered_type=this.style=void 0,this.render_dirty=!0},t.prototype.FlushArray=function(){this.area=void 0},t.prototype.FlushCache=function(){this.calculated=this.calculated_type=this.formatted=this.rendered_type=this.render_function=this.click_function=void 0,this.render_dirty=!0},t.prototype.Reset=function(){this.type=r.undefined,this.value=this.note=this.hyperlink=this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=this.area=this.renderer_data=this.render_function=this.click_function=void 0,this.render_dirty=!0},t.prototype.Set=function(t,e){void 0===e&&(e=h(t)),this.value=t,this.type=e,this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=this.render_function=this.click_function=this.area=void 0,this.render_dirty=!0},t.prototype.SetCalculatedValue=function(t,e){void 0===e&&(e=h(t)),this.calculated!==t&&(this.calculated=t,this.calculated_type=e,this.formatted=this.rendered_type=void 0,this.render_dirty=!0)},t.prototype.SetCalculatedValueOrError=function(t,e){void 0===e&&("object"==typeof t&&t.error?(e=r.error,t=t.error):e=h(t)),this.calculated!==t&&(this.calculated=t,this.calculated_type=e,this.formatted=this.rendered_type=void 0,this.render_dirty=!0)},t.prototype.GetValue=function(){return this.calculated_type?this.calculated:"string"==typeof this.value&&"'"===this.value[0]?this.value.slice(1):this.value},t.prototype.GetValue4=function(){return this.calculated_type?{type:this.calculated_type,value:this.calculated}:this.type===r.formula?{type:r.number,value:0}:{type:this.type,value:"string"==typeof this.value&&"'"===this.value[0]?this.value.slice(1):this.value}},t.prototype.SetNote=function(t){this.note=t,this.render_dirty=!0},t.prototype.SetCalculationError=function(t){void 0===t&&(t="ERR"),this.SetCalculatedValue(t,r.error)},t.prototype.SetArray=function(t){this.type=r.undefined,this.value=this.formatted=this.rendered_type=this.style=this.hyperlink=this.calculated=this.calculated_type=void 0,this.area=t,this.render_dirty=!0},t.prototype.SetArrayHead=function(t,e){this.type=h(e),this.value=e,this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=void 0,this.area=t,this.render_dirty=!0},t}(),u=function(){return(u=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},l=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]])}return r},d=(function(){function t(){this.data=[],this.rows_=0,this.columns_=0}Object.defineProperty(t.prototype,"rows",{get:function(){return this.rows_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.columns_},enumerable:!1,configurable:!0}),t.prototype.EnsureRow=function(t){this.rows_=Math.max(t+1,this.rows_)},t.prototype.EnsureColumn=function(t){this.columns_=Math.max(t+1,this.columns_)},t.prototype.InsertColumns=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1),this.data=this.data.map((function(r){if(r.length>=t){var n=r.slice(0,t),i=t+e;return r.slice(t).forEach((function(t){return n[i++]=t})),n}return r})),this.columns_+=e},t.prototype.DeleteColumns=function(t,e){void 0===e&&(e=1),this.data.forEach((function(r){return r.splice(t,e)})),this.columns_-=e},t.prototype.DeleteRows=function(t,e){void 0===e&&(e=1),this.data.splice(t,e),this.rows_-=e},t.prototype.InsertRows=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1);for(var r=[t,0,[]],n=1;n<e;n++)r.push([]);Array.prototype.splice.apply(this.data,r),this.rows_+=e},t.prototype.GetCell=function(t,e){var r=t.row,n=t.column;if(!this.data[r]){if(!e)return;this.data[r]=[],this.rows_=Math.max(this.rows_,r+1)}return this.data[r][n]||e&&(this.data[r][n]=new c,this.columns_=Math.max(this.columns_,n+1)),this.data[r][n]},t.prototype.EnsureCell=function(t){var e=t.row,r=t.column,n=this.data[e];n||(this.data[e]=n=[],this.rows_=Math.max(this.rows_,e+1));var i=n[r];return i||(i=n[r]=new c,this.columns_=Math.max(this.columns_,r+1)),i},t.prototype.FromArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=!1),this.data=[];var r=0,n=0;if(e){n=t.length;for(var i=0;i<n;i++){var o=t[i];r=Math.max(r,o.length);for(var a=0;a<o.length;a++)this.data[a]||(this.data[a]=[]),this.data[a][i]=new c(o[a])}}else for(r=t.length,a=0;a<r;a++){var s=[];for(o=t[a],n=Math.max(n,o.length),i=0;i<o.length;i++)s[i]=new c(o[i]);this.data[a]=s}this.rows_=r,this.columns_=n},t.prototype.FromJSON=function(t,e){if(void 0===t&&(t=[]),this.data=[],!(_=t)[0]||!function(t){return!t.cells}(_[0])){var r=[];if(function(t){return!!t[0]&&void 0!==t[0].row}(t))for(var n=0,i=t;n<i.length;n++)for(var o=0,s=(p=i[n]).cells;o<s.length;o++){var h=s[o];r.push(u(u({},h),{row:p.row}))}else for(var l=0,d=t;l<d.length;l++)for(var p,f=0,m=(p=d[l]).cells;f<m.length;f++)h=m[f],r.push(u(u({},h),{column:p.column}));t=r}for(var _,g=0,v=t;g<v.length;g++){var y=v[g];if(this.data[y.row]||(this.data[y.row]=[]),h=new c(y.value),void 0!==y.calculated&&h.SetCalculatedValue(y.calculated,y.calculated_type),e&&void 0!==y.style_ref&&(h.style=e[y.style_ref]),void 0!==y.note&&(h.note=y.note),void 0!==y.hyperlink&&(h.hyperlink=y.hyperlink),this.data[y.row][y.column]&&this.data[y.row][y.column].area&&(h.area=this.data[y.row][y.column].area),this.data[y.row][y.column]=h,y.area)for(var w=new a(y.area.start,y.area.end),x=w.start.row;x<=w.end.row;x++)for(var b=w.start.column;b<=w.end.column;b++)this.data[x]||(this.data[x]=[]),this.data[x][b]||(this.data[x][b]=new c),this.data[x][b].area=w;if(y.merge_area){var C=new a(y.merge_area.start,y.merge_area.end);for(x=C.start.row;x<=C.end.row;x++)for(b=C.start.column;b<=C.end.column;b++)this.data[x]||(this.data[x]=[]),this.data[x][b]||(this.data[x][b]=new c),this.data[x][b].merge_area=C}y.validation&&(h.validation=y.validation)}this.rows_=this.data.length,this.columns_=this.data.reduce((function(t,e){return Math.max(t,e.length)}),0)},t.prototype.toJSON=function(t){void 0===t&&(t={});var e,n=0,i=0,o=this.data.length-1;t.subset&&(n=t.subset.start.column,i=t.subset.start.row,o=t.subset.end.row);for(var a=[],s=-1,h=-1,c={},u={},d=i;d<=o;d++)if(this.data[d]){var p=this.data[d];e=p.length-1,t.subset&&(e=t.subset.end.column);for(var f=n;f<=e;f++){var m=p[f],_=m&&m.merge_area&&m.merge_area.start.row===d&&m.merge_area.start.column===f,g=m&&m.area&&m.area.start.row===d&&m.area.start.column===f,v=!m||m.type===r.string&&!m.value;if(m&&(!v||t.preserve_empty_strings)&&(_||m.type||m.calculated_type&&t.expand_arrays||m.calculated_type&&t.calculated_value||m.validation||t.decorated_cells&&m.style&&(m.style.fill||m.style.border_bottom||m.style.border_top||m.style.border_left||m.style.border_right))){var y={row:d,column:f,value:m.value};m.note&&(y.note=m.note),m.hyperlink&&(y.hyperlink=m.hyperlink),t.preserve_type&&(y.type=m.type),t.sheet_id&&(y.sheet_id=t.sheet_id),t.calculated_value&&void 0!==m.calculated&&(y.calculated=m.calculated,(t.preserve_type||m.calculated_type===r.error)&&(y.calculated_type=m.calculated_type)),m.area&&g&&(y.area=m.area.toJSON()),m.merge_area&&(y.merge_area=m.merge_area.toJSON()),m.validation&&(y.validation=m.validation),t.cell_style_refs&&t.cell_style_refs[f]&&t.cell_style_refs[f][d]&&(y.style_ref=t.cell_style_refs[f][d],t.cell_style_refs[f][d]=0),c[d]=d,u[f]=f,s=Math.max(d,s),h=Math.max(f,h),a.push(y)}}}if(t.nested){var w=Object.keys(c),x=Object.keys(u);if(w.length<=x.length&&w.length){for(var b={},C=[],S=0,T=a;S<T.length;S++){d=(O=T[S]).row;var M=l(O,["row"]);b[O.row]||(b[O.row]=[]),b[O.row].push(M)}for(var A=0,P=w;A<P.length;A++){var D=P[A];d=Number(D),C.push({row:d,cells:b[d]})}return{data:C,rows:s,columns:h+1}}if(x.length){b={},C=[];for(var N=0,k=a;N<k.length;N++){var O;f=(O=k[N]).column,M=l(O,["column"]),b[O.column]||(b[O.column]=[]),b[O.column].push(M)}for(var F=0,j=x;F<j.length;F++)D=j[F],f=Number(D),C.push({column:f,cells:b[f]});return{data:C,rows:s,columns:h+1}}}return{data:a,rows:s+1,columns:h+1}},t.prototype.GetAll=function(t){return void 0===t&&(t=!1),this.GetRange({row:0,column:0},{row:this.rows_-1,column:this.columns_-1},t)},t.prototype.Normalize2=function(t,e){return t.column===1/0&&(t=u(u({},t),{column:0})),t.row===1/0&&(t=u(u({},t),{row:0})),e.column===1/0&&(e=u(u({},e),{column:this.columns_-1})),e.row===1/0&&(e=u(u({},e),{row:this.rows_-1})),{from:t,to:e}},t.prototype.Normalize1=function(t){return t.column===1/0&&(t=u(u({},t),{column:0})),t.row===1/0&&(t=u(u({},t),{row:0})),t},t.prototype.RawValue=function(t,e){var r;if(void 0===e&&(e=t),t=(r=this.Normalize2(t,e)).from,e=r.to,t.row===e.row&&t.column===e.column)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].value:void 0;for(var n=[],i=this.data.slice(t.row,e.row+1),o=t.column,a=e.column+1,s=0,h=i;s<h.length;s++){for(var c=h[s],u=[],l=o,d=0;l<a;l++,d++){var p=c[l];u.push(p?p.value:void 0)}n.push(u)}return n},t.prototype.GetRange=function(t,e,r){var n;if(void 0===r&&(r=!1),e?(t=(n=this.Normalize2(t,e)).from,e=n.to):t=this.Normalize1(t),!e||t===e||t.column===e.column&&t.row===e.row)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].GetValue():void 0;var i=[];if(r)for(var o=t.column;o<=e.column;o++){for(var a=[],s=t.row;s<=e.row;s++)this.data[s]&&this.data[s][o]?a.push(this.data[s][o].GetValue()):a.push(void 0);i.push(a)}else for(s=t.row;s<=e.row;s++){var h=[];for(o=t.column;o<=e.column;o++)this.data[s]&&this.data[s][o]?h.push(this.data[s][o].GetValue()):h.push(void 0);i.push(h)}return i},t.prototype.GetRange4=function(t,e,n){var i;if(void 0===e&&(e=t),void 0===n&&(n=!1),t=(i=this.Normalize2(t,e)).from,e=i.to,t.row===e.row&&t.column===e.column)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].GetValue4():{value:void 0,type:r.undefined};var o=[];if(n)for(var a=t.column;a<=e.column;a++){for(var s=[],h=t.row;h<=e.row;h++)this.data[h]&&this.data[h][a]?s.push(this.data[h][a].GetValue4()):s.push({type:r.undefined});o.push(s)}else for(h=t.row;h<=e.row;h++){var c=[];for(a=t.column;a<=e.column;a++)this.data[h]&&this.data[h][a]?c.push(this.data[h][a].GetValue4()):c.push({type:r.undefined});o.push(c)}return{type:r.array,value:o}},t.prototype.Apply=function(t,e,r){var n;if(void 0===r&&(r=!1),"object"==typeof(n=t)&&void 0!==n.row&&void 0!==n.column&&(t=new a(t)),t.entire_column||t.entire_row)throw new Error("don't iterate infinite cells");var i=t.start,o=t.end;if(r)for(var s=i.row;s<=o.row;s++){this.data[s]||(this.data[s]=[]);for(var h=this.data[s],u=i.column;u<=o.column;u++)h[u]||(h[u]=new c),e(h[u],u,s)}else for(s=i.row;s<=o.row;s++)if(this.data[s])for(h=this.data[s],u=i.column;u<=o.column;u++)h[u]&&e(h[u],u,s)},t.prototype.SetArea=function(t,e){if(ArrayBuffer.isView(e))throw new Error("ABIV");if(Array.isArray(e))for(var r=t.start.row,n=0;r<=t.end.row;r++,n++){this.data[r]||(this.data[r]=[]);var i=this.data[r];if(e[n])for(var o=t.start.column,a=0;o<=t.end.column;o++,a++)i[o]||(i[o]=new c),i[o].Set(e[n][a])}else{var s=h(e);for(r=t.start.row;r<=t.end.row;r++)for(this.data[r]||(this.data[r]=[]),i=this.data[r],o=t.start.column;o<=t.end.column;o++)i[o]||(i[o]=new c),i[o].Set(e,s)}this.rows_=Math.max(this.rows_,t.end.row+1),this.columns_=Math.max(this.columns_,t.end.column+1)},t.prototype.IterateAll=function(t){for(var e=0,r=this.data;e<r.length;e++){var n=r[e];if(n)for(var i=0,o=n;i<o.length;i++){var a=o[i];a&&t(a)}}},t.prototype.FlushCellStyles=function(){for(var t=0,e=this.data;t<e.length;t++){var r=e[t];if(r)for(var n=0,i=r;n<i.length;n++){var o=i[n];o&&o.FlushStyle()}}},t.prototype.FlushCachedValues=function(){for(var t=0,e=this.data;t<e.length;t++){var r=e[t];if(r)for(var n=0,i=r;n<i.length;n++){var o=i[n];o&&o.FlushCache()}}}}(),function(){function t(){}return t.UpdateLocale=function(t){var e;if(t)this.locale=t;else if("undefined"!=typeof self){var r=null===(e=null===self||void 0===self?void 0:self.document)||void 0===e?void 0:e.location;if(r&&r.search&&/locale=([^?&]+?)(?:\?|$|&)/.test(r.search)){var n=r.search.match(/locale=(.*?)(?:\?|$|&)/);n&&(this.locale=n[1]),console.info("override locale",this.locale)}else"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]?this.locale=navigator.languages[0]:this.locale=navigator.language)}var i=new Intl.NumberFormat(this.locale,{minimumFractionDigits:1}).format(3.3).replace(/\d/g,"");this.decimal_separator=","===i?",":".",","===this.decimal_separator&&(this.argument_separator=";",this.grouping_separator=" ");var o=new Date(2e3,0,2,12,0,0,0);this.UpdateDateComponent(0,0,o),o=new Date(2e3,1,7,12,0,0,0),this.UpdateDateComponent(1,1,o),o=new Date(2e3,2,7,12,0,0,0),this.UpdateDateComponent(2,2,o),o=new Date(2e3,3,5,12,0,0,0),this.UpdateDateComponent(3,3,o),o=new Date(2e3,4,4,12,0,0,0),this.UpdateDateComponent(4,4,o),o=new Date(2e3,5,2,12,0,0,0),this.UpdateDateComponent(5,5,o),o=new Date(2e3,6,1,12,0,0,0),this.UpdateDateComponent(6,6,o),o=new Date(2e3,7,1,12,0,0,0),this.UpdateDateComponent(7,-1,o),o=new Date(2e3,8,1,12,0,0,0),this.UpdateDateComponent(8,-1,o),o=new Date(2e3,9,1,12,0,0,0),this.UpdateDateComponent(9,-1,o),o=new Date(2e3,10,1,12,0,0,0),this.UpdateDateComponent(10,-1,o),o=new Date(2e3,11,1,12,0,0,0),this.UpdateDateComponent(11,-1,o)},t.UpdateDateComponent=function(t,e,r){e>=0&&(this.date_components.short_days[e]=r.toLocaleString(this.locale,{weekday:"short"}),this.date_components.long_days[e]=r.toLocaleString(this.locale,{weekday:"long"})),t>=0&&(this.date_components.short_months[t]=r.toLocaleString(this.locale,{month:"short"}),this.date_components.long_months[t]=r.toLocaleString(this.locale,{month:"long"}))},t.locale="en-us",t.decimal_separator=".",t.argument_separator=",",t.grouping_separator=",",t.date_components={short_days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],long_days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short_months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],long_months:["January","February","March","April","May","June","July","August","September","October","November","December"]},t}());d.UpdateLocale(),function(){function t(t,e,r,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=0),this.left=t,this.top=e,this.width=r,this.height=n}Object.defineProperty(t.prototype,"right",{get:function(){return this.left+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.top+this.height},enumerable:!1,configurable:!0}),t.Create=function(e){return new t(e.left||0,e.top||0,e.width||0,e.height||0)},t.IsRectangle=function(t){var e,r,n,i;return"object"==typeof t&&"number"==typeof(null===(e=t)||void 0===e?void 0:e.left)&&"number"==typeof(null===(r=t)||void 0===r?void 0:r.top)&&"number"==typeof(null===(n=t)||void 0===n?void 0:n.width)&&"number"==typeof(null===(i=t)||void 0===i?void 0:i.height)},t.prototype.Shift=function(e,r){return void 0===e&&(e=0),void 0===r&&(r=0),new t(this.left+e,this.top+r,this.width,this.height)},t.prototype.Scale=function(e,r){return void 0===e&&(e=1),void 0===r&&(r=e),new t(this.left*e,this.top*r,this.width*e,this.height*r)},t.prototype.Expand=function(e,r){return void 0===e&&(e=0),void 0===r&&(r=0),new t(this.left,this.top,this.width+e,this.height+r)},t.prototype.Combine=function(e){return new t(Math.min(this.left,e.left),Math.min(this.top,e.top),Math.max(this.right,e.right)-Math.min(this.left,e.left),Math.max(this.bottom,e.bottom)-Math.min(this.top,e.top))},t.prototype.CheckEdges=function(t,e,r){void 0===r&&(r=16);var n=0;return t-this.left<r&&(n|=1),this.right-t<r&&(n|=2),e-this.top<r&&(n|=4),this.bottom-e<r&&(n|=8),n},t.prototype.Contains=function(t,e,r){return void 0===r&&(r=0),t>=this.left-r&&t<=this.left+this.width+r&&e>=this.top-r&&e<=this.top+this.height+r},t.prototype.ContextFill=function(t){t.fillRect(this.left,this.top,this.width,this.height)},t.prototype.ContextStroke=function(t){t.strokeRect(this.left,this.top,this.width,this.height)},t.prototype.Clamp=function(t,e){return{x:t=Math.min(Math.max(t,this.left),this.right),y:e=Math.min(Math.max(e,this.top),this.bottom)}},t.prototype.ApplyStyle=function(t){t.style.top=this.top+"px",t.style.left=this.left+"px",t.style.width=this.width+"px",t.style.height=this.height+"px"},t.prototype.toJSON=function(){return{top:this.top,left:this.left,width:this.width,height:this.height}}}();var p,f,m,_=function(){return(_=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};!function(t){var e,r,n=JSON.stringify({});!function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=3]="Right"}(e=t.HorizontalAlign||(t.HorizontalAlign={})),function(t){t[t.None=0]="None",t[t.Top=1]="Top",t[t.Bottom=2]="Bottom",t[t.Middle=3]="Middle"}(r=t.VerticalAlign||(t.VerticalAlign={})),t.DefaultProperties={horizontal_align:e.None,vertical_align:r.None,number_format:"General",nan:"NaN",font_size:{unit:"pt",value:10},font_face:"calibri",bold:!1,italic:!1,underline:!1,strike:!1,text:{theme:1},border_top:0,border_left:0,border_right:0,border_bottom:0},t.CompositeBorders=function(t){return{top:{width:t.border_top||0,color:t.border_top_fill||{}},left:{width:t.border_left||0,color:t.border_left_fill||{}},right:{width:t.border_right||0,color:t.border_right_fill||{}},bottom:{width:t.border_bottom||0,color:t.border_bottom_fill||{}}}},t.Merge=function(t,e,r){void 0===r&&(r=!0);var n=_(r?_({},t):{},e);return JSON.parse(JSON.stringify(n))},t.Composite=function(t){return JSON.parse(JSON.stringify(t.reduce((function(t,e){return _(_({},t),e)}),{})))},t.Empty=function(t){return JSON.stringify(t)===n},t.ValidColor=function(t){return!(!t||t.none||!t.text&&!t.theme&&0!==t.theme)},t.ParseFontSize=function(t,e){void 0===t&&(t=""),void 0===e&&(e="em");var r=t.match(/(-*[\d.]+)\s*(\S*)/);if(r){var n=Number(r[1]);if(!n||isNaN(n)||n<0)return{};var i=r[2].toLowerCase()||e;if("pt"===i||"em"===i||"%"===i||"px"===i)return{font_size:{unit:i,value:n}}}return{}},t.RelativeFontSize=function(t,e){var r,n,i=12,o=12;switch(null===(r=t.font_size)||void 0===r?void 0:r.unit){case"pt":if(!t.font_size.value)return 1;o=t.font_size.value;break;case"px":if(!t.font_size.value)return 1;o=Math.round(300*t.font_size.value/4)/100;break;case"em":return t.font_size.value||1;case"%":return(t.font_size.value||100)/100;default:return 1}switch(null===(n=e.font_size)||void 0===n?void 0:n.unit){case"pt":if(!e.font_size.value)return 1;i=e.font_size.value;break;case"px":if(!e.font_size.value)return 1;i=Math.round(300*e.font_size.value/4)/100;break;default:return 1}return o/i},t.FontSize=function(t,e){var r,n;void 0===e&&(e=!0);var i=null===(r=t.font_size)||void 0===r?void 0:r.value;switch(null===(n=t.font_size)||void 0===n?void 0:n.unit){case"pt":return(i||12)+"pt";case"px":return e?Math.round(300*(i||16)/4)/100+"pt":(i||16)+"px";case"em":return(i||1)+"em";case"%":return(i||100)+"%"}return""},t.Font=function(t,e){var r,n;void 0===e&&(e=1);var i=[];return t.bold&&i.push("bold"),t.italic&&i.push("italic"),i.push((((null===(r=t.font_size)||void 0===r?void 0:r.value)||0)*e).toFixed(2)+((null===(n=t.font_size)||void 0===n?void 0:n.unit)||"pt")),i.push(t.font_face||""),i.join(" ")}}(p||(p={})),function(t){t[t.default=0]="default",t[t.hidden=1]="hidden",t[t.padded=2]="padded",t[t.date_component=3]="date_component",t[t.date_component_minutes=4]="date_component_minutes",t[t.literal=5]="literal",t[t.formatting=6]="formatting"}(f||(f={})),new(function(){function t(){}return t.prototype.Darken=function(t,e,r,n,i){void 0===i&&(i=!1);var o=this.RGBToHSL(t,e,r),a=o.h,s=o.s,h=o.l;return h-=i?h*n/100:n/100,h=Math.max(0,Math.min(1,h)),this.HSLToRGB(a,s,h)},t.prototype.Lighten=function(t,e,r,n,i){void 0===i&&(i=!1);var o=this.RGBToHSL(t,e,r),a=o.h,s=o.s,h=o.l;return h+=i?h*n/100:n/100,h=Math.max(0,Math.min(1,h)),this.HSLToRGB(a,s,h)},t.prototype.RGBToHSL=function(t,e,r){t/=255,e/=255,r/=255;var n=Math.max(t,e,r),i=Math.min(t,e,r),o=0,a=0,s=(n+i)/2;if(n===i)o=a=0;else{var h=n-i;switch(a=s>.5?h/(2-n-i):h/(n+i),n){case t:o=(e-r)/h+(e<r?6:0);break;case e:o=(r-t)/h+2;break;case r:o=(t-e)/h+4}o/=6}return{h:360*o,s:a,l:s}},t.prototype.HSLToRGB=function(t,e,r){var n,i,o;if(0===e)n=i=o=r;else{t/=360;var a=r<.5?r*(1+e):r+e-r*e,s=2*r-a;n=this.HueToRGB(s,a,t+1/3),i=this.HueToRGB(s,a,t),o=this.HueToRGB(s,a,t-1/3)}return{r:Math.round(255*n),g:Math.round(255*i),b:Math.round(255*o)}},t.prototype.HueToRGB=function(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t},t}()),function(t){t[t.Integer=0]="Integer",t[t.Decimal=1]="Decimal"}(m||(m={}));var g,v=function(){function t(){}return t.Parse=function(t){if(this.pattern=t,this.characters=t.split("").map((function(t){return t.charCodeAt(0)})),this.char_index=0,this.current_section=new i,this.sections=[this.current_section],this.ParseDatePattern())return this.sections;for(this.char_index=0,this.current_section=new i,this.sections=[this.current_section];this.char_index<this.characters.length;)this.ConsumeChar();return this.sections},t.ConsumeString=function(){var t="";for(this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),++this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case 92:this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),this.char_index+1<this.characters.length&&(t+=this.pattern[++this.char_index]);break;case 34:return this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),this.char_index++,t;default:t+=this.pattern[this.char_index]}throw new Error("unterminated string")},t.ConsumeFormatting=function(){var t="";for(++this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case 92:throw new Error("invalid escape character in formatting block");case 93:return this.char_index++,t;default:t+=this.pattern[this.char_index]}throw new Error("unterminated format")},t.ScanFractionFormat=function(){var t=this.pattern.substr(this.char_index).match(/^([#?]+ +){0,1}([#?]+)\/([#?0-9]+)(?:$|[^#?0-9])/);if(!t)return!1;var e=(t[1]||"").length+t[2].length+t[3].length+1;this.current_section.fraction_format=!0,this.current_section.fraction_integer=!!t[1];var r=Number(t[3]);return isNaN(r)||(this.current_section.fraction_denominator=r),this.current_section.decimal_max_digits=this.current_section.fraction_denominator_digits=t[3].length,this.char_index+=e,this.current_section.has_number_format=!0,!0},t.ConsumeNumberFormat=function(){var t=m.Integer;for(this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case this.group_separator:for(var e=!1,r=this.char_index+1;!e&&r<this.characters.length;r++){var n=this.characters[r];if(n===this.decimal_mark||35===n||48===n)e=!0;else if(44!==n)break}if(e){if(t===m.Decimal)throw new Error("invalid grouping in decimal part");this.current_section.grouping=!0}else this.current_section.scaling=1e3*(this.current_section.scaling||1);break;case this.decimal_mark:if(t===m.Decimal)throw new Error("too many decimal marks");t=m.Decimal;break;case 35:t===m.Decimal?this.current_section.decimal_max_digits++:this.current_section.integer_min_digits&&this.current_section.integer_min_digits++;break;case 48:t===m.Decimal?(this.current_section.decimal_max_digits++,this.current_section.decimal_min_digits=this.current_section.decimal_max_digits):this.current_section.integer_min_digits++;break;default:return}},t.AppendCharAsText=function(t){void 0===t&&(t=!0),this.current_section.has_number_format?this.current_section.suffix[this.current_section.suffix.length-1].text+=this.pattern[this.char_index]:this.current_section.prefix[this.current_section.prefix.length-1].text+=this.pattern[this.char_index],t&&this.char_index++},t.AppendString=function(t){this.current_section.has_number_format?this.current_section.suffix[this.current_section.suffix.length-1].text+=t:this.current_section.prefix[this.current_section.prefix.length-1].text+=t},t.AppendTextPart=function(t){this.current_section.has_number_format?(this.current_section.suffix.push(t),this.current_section.suffix.push({text:""})):(this.current_section.prefix.push(t),this.current_section.prefix.push({text:""}))},t.ConsumeChar=function(){var t=this.characters[this.char_index];if(63!==t&&35!==t||this.current_section.has_number_format||this.current_section.string_format||!this.ScanFractionFormat())switch(t){case 59:this.char_index++,this.current_section=new i,3===this.sections.length&&(this.current_section.string_format=!0),this.sections.push(this.current_section);break;case 64:this.char_index++,this.AppendTextPart({text:"@",flag:f.literal}),this.current_section.string_format=!0;break;case 48:case 35:case 46:case 44:this.current_section.has_number_format||this.current_section.string_format?this.AppendCharAsText():(this.ConsumeNumberFormat(),this.current_section.has_number_format=!0);break;case 91:this.AppendTextPart({text:this.ConsumeFormatting(),flag:f.formatting});break;case 34:this.AppendString(this.ConsumeString());break;case 63:this.preserve_formatting_characters?this.AppendCharAsText():(this.AppendTextPart({text:"0",flag:f.hidden}),this.char_index++);break;case 95:if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:f.hidden})}break;case 42:if(this.current_section.has_asterisk)throw new Error("we don't support multiple asterisks");if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:f.padded}),this.current_section.has_asterisk=!0}break;case 101:case 69:this.current_section.percent||this.current_section.exponential||this.current_section.string_format?this.AppendCharAsText():(this.current_section.exponential=!0,this.char_index++);break;case 37:this.current_section.exponential||this.current_section.string_format||(this.current_section.percent=!0),this.AppendCharAsText();break;case 92:if(this.preserve_formatting_characters&&this.AppendCharAsText(!1),++this.char_index>=this.characters.length)throw new Error("invalid escape character at end");this.AppendCharAsText();break;default:this.AppendCharAsText()}},t.ParseDatePattern=function(){var t=this;for(this.date_pattern=!0;this.date_pattern&&this.char_index<this.pattern.length;)this.DatePatternConsumeChar();if(this.date_pattern){this.date_pattern=!1;for(var e=0,r=this.sections;e<r.length;e++)for(var n=0,i=r[e].prefix;n<i.length;n++){var o=i[n];o.flag&&o.flag&(f.date_component|f.date_component_minutes)&&(this.date_pattern=!0)}}return this.date_pattern&&(this.sections[0].date_format=!0,this.sections[0].prefix.forEach((function(e,r){if(e.flag===f.date_component&&("mm"===e.text||"m"===e.text)){if(r)for(var n=r-1;n;n--)if((i=t.sections[0].prefix[n]).flag===f.date_component){/h/i.test(i.text)&&(e.flag=f.date_component_minutes,e.text=e.text.toLowerCase());break}if(r<t.sections[0].prefix.length-1)for(n=r+1;n<t.sections[0].prefix.length;n++){var i;if((i=t.sections[0].prefix[n]).flag===f.date_component){/s/i.test(i.text)&&(e.flag=f.date_component_minutes,e.text=e.text.toLowerCase());break}}}}))),this.date_pattern},t.ConsumeDatePart=function(){for(var t=this.pattern[this.char_index++],e=t.toLowerCase(),r={text:t,flag:f.date_component};this.pattern[this.char_index]&&this.pattern[this.char_index].toLowerCase()===e;)r.text+=this.pattern[this.char_index++];if("s"===e&&"."===this.pattern[this.char_index])for(r.text+=this.pattern[this.char_index++];"0"===this.pattern[this.char_index];)r.text+=this.pattern[this.char_index++];return r},t.ConsumeAMPM=function(){var t=this.pattern.substr(this.char_index,5);return"am/pm"===t||"AM/PM"===t?(this.char_index+=5,this.sections[0].twelve_hour=!0,{text:t,flag:f.date_component}):"a/p"===(t=this.pattern.substr(this.char_index,3))||"A/P"===t?(this.char_index+=3,this.sections[0].twelve_hour=!0,{text:t,flag:f.date_component}):void 0},t.DatePatternConsumeChar=function(){switch(this.characters[this.char_index]){case 59:this.char_index=this.characters.length;break;case 48:case 35:case 101:case 69:case 37:case 64:this.date_pattern=!1;break;case 72:case 104:case 77:case 109:case 83:case 115:case 68:case 100:case 89:case 121:this.AppendTextPart(this.ConsumeDatePart());break;case 65:case 97:var t=this.ConsumeAMPM();t?this.AppendTextPart(t):this.AppendCharAsText();break;case 34:this.AppendString(this.ConsumeString());break;case 63:this.preserve_formatting_characters?this.AppendCharAsText():(this.AppendTextPart({text:"0",flag:f.hidden}),this.char_index++);break;case 95:if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:f.hidden})}break;case 42:if(this.current_section.has_asterisk)throw new Error("we don't support multiple asterisks");if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:f.padded}),this.current_section.has_asterisk=!0}break;case 92:if(this.preserve_formatting_characters&&this.AppendCharAsText(!1),++this.char_index>=this.characters.length)throw new Error("invalid escape character at end");this.AppendCharAsText();break;default:this.AppendCharAsText()}},t.date_pattern=!1,t.pattern="",t.char_index=0,t.characters=[],t.sections=[],t.current_section=new i,t.preserve_formatting_characters=!1,t.decimal_mark=46,t.group_separator=44,t}(),y=function(){return(y=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},w=function(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))},x=function(t){return t>=60&&t--,new Date(864e5*t-22090752e5)},b=function(t,e){if(void 0===e&&(e=!0),e){var r=new Date(t),n=new Date;n.setUTCMilliseconds(r.getUTCMilliseconds()),n.setUTCSeconds(r.getUTCSeconds()),n.setUTCMinutes(r.getUTCMinutes()),n.setUTCHours(r.getHours()),n.setUTCDate(r.getDate()),n.setUTCMonth(r.getMonth()),n.setUTCFullYear(r.getFullYear()),t=n.getTime()}return(t=(t+22090752e5)/864e5)>=60&&t++,t},C=function(){function t(t){if(this.magic_decimal=!1,this._pattern="",this.decimal_zero_regexp=[],this.cloned=[],this._pattern=t,this.sections=v.Parse(t),this.sections.length||(this.sections=[]),this.sections[0]||(this.sections[0]=new i),this.sections[1]||(this.sections[1]=y({},this.sections[0]),this.sections[1].prefix=JSON.parse(JSON.stringify(this.sections[1].prefix)),this.sections[1].suffix=JSON.parse(JSON.stringify(this.sections[1].suffix)),this.sections[1].prefix.push({text:"-"}),this.cloned[1]=!0),this.sections[2]||(this.sections[2]=y({},this.sections[0]),this.cloned[2]=!0),!this.sections[3])for(var e=0,r=this.sections[0].prefix;e<r.length;e++)if(r[e].flag===f.literal){this.sections[3]=y({},this.sections[0]),this.sections[3].string_format=!0,this.cloned[3]=!0;break}this.decimal_zero_regexp=this.sections.map((function(t){if(t.decimal_max_digits>t.decimal_min_digits)return new RegExp("0{1,"+(t.decimal_max_digits-t.decimal_min_digits)+"}(?:$|e)")}))}return Object.defineProperty(t.prototype,"pattern",{get:function(){return this._pattern},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"date_format",{get:function(){return this.sections[0]&&this.sections[0].date_format},enumerable:!1,configurable:!0}),t.FormatPartsAsText=function(t,e){void 0===e&&(e=0);var r=-1,n=t.map((function(t,e){switch(t.flag){case f.padded:return r=e,t.text;case f.hidden:return t.text.replace(/./g," ");case f.formatting:return"";default:return t.text}}));if(r>=0&&e){for(var i=n.reduce((function(t,e,n){return n===r?t:t+e.length}),0),o="",a=0;a<e-i;a++)o+=n[r];n[r]=o}return n.join("")},t.prototype.IncreaseDecimal=function(){this.sections.forEach((function(t){t.fraction_format?t.fraction_denominator||(t.fraction_denominator_digits=Math.min(t.fraction_denominator_digits+1,4)):(t.decimal_min_digits++,t.decimal_max_digits=t.decimal_min_digits)}))},t.prototype.DecreaseDecimal=function(){this.sections.forEach((function(t){t.fraction_format?t.fraction_denominator||(t.fraction_denominator_digits=Math.max(t.fraction_denominator_digits-1,1)):(t.decimal_min_digits=Math.max(0,t.decimal_min_digits-1),t.decimal_max_digits=t.decimal_min_digits)}))},t.prototype.AddGrouping=function(){this.sections.forEach((function(t){t.grouping=!0}))},t.prototype.RemoveGrouping=function(){this.sections.forEach((function(t){t.grouping=!1}))},t.prototype.ToggleGrouping=function(){var t=!this.sections[0].grouping;this.sections.forEach((function(e){e.grouping=t}))},t.prototype.toString=function(){var t=this;return this.sections[0].date_format?this._pattern:this.sections.filter((function(e,r){return!t.cloned[r]})).map((function(t){var e="",r=0;if(t.fraction_format){t.fraction_integer&&(e+="? ");for(var n="",i=0;i<t.fraction_denominator_digits;i++)n+="#";e+=n,e+="/",t.fraction_denominator?e+=t.fraction_denominator:e+=n}else if(t.has_number_format){for(r=0;r<t.integer_min_digits;r++)e+="0";if(t.grouping&&(e.length<4&&(e=("####"+e).slice(-4)),e=e.replace(/[\d#]{1,3}(?=([\d#]{3})+(?![\d#]))/g,"$&,")),t.decimal_max_digits||t.decimal_min_digits){for(e+=".",r=0;r<t.decimal_min_digits;r++)e+="0";for(;r<t.decimal_max_digits;r++)e+="#"}if(t.scaling){var o=Math.log10(t.scaling)/3;for(r=0;r<o;r++)e+=","}t.exponential&&(e+="e")}return t.prefix.map((function(t){return t.flag===f.hidden?"0"===t.text?"?":"_"+t.text:t.flag===f.padded?"*"+t.text:t.flag===f.formatting?"["+t.text+"]":t.text})).join("")+e+t.suffix.map((function(t){return t.flag===f.hidden?"0"===t.text?"?":"_"+t.text:t.flag===f.padded?"*"+t.text:t.text})).join("")})).join(";")},t.prototype.FormatComplex=function(e){var r=!!e.imaginary;r&&(r=this.FormatParts(e.imaginary).some((function(t){return/[1-9]/.test(t.text)})));var n=!!e.real;n&&(n=this.FormatParts(e.real).some((function(t){return/[1-9]/.test(t.text)})));var i=[];return n||!n&&!r?(i.push.apply(i,this.FormatParts(e.real)),r&&(Math.abs(e.imaginary),i.push({text:e.imaginary<0?" "+t.minus_character+" ":" + "}),i.push.apply(i,w(w([],this.FormatParts(Math.abs(e.imaginary)),!1),[{text:t.imaginary_character}],!1)))):r&&i.push.apply(i,w(w([],this.FormatParts(e.imaginary),!1),[{text:t.imaginary_character}],!1)),i},t.prototype.FormatParts=function(t){if("number"!=typeof t&&!this.sections[3])return[{text:t.toString()}];var e=this.BaseFormat(t),r=e.parts,n=e.section,i=[];if(n.date_format||n.string_format)for(var o=0,a=r;o<a.length;o++){var s=a[o];"string"==typeof s?i.push({text:s}):i.push(s)}else this.magic_decimal&&""===r[1]&&r.splice(1,1),i=w(w(w([],n.prefix.map((function(t){return y({},t)})),!0),[{text:n.has_number_format?r.join(d.decimal_separator):""}],!1),n.suffix.map((function(t){return y({},t)})),!0);for(var h=1;h<i.length;h++)i[h].flag===i[h-1].flag&&(i[h].text=i[h-1].text+i[h].text,i[h-1].text="");return i.filter((function(t){return t.text}))},t.prototype.Format=function(e,r){return void 0===r&&(r=0),t.FormatPartsAsText(this.FormatParts(e),r)},t.prototype.ZeroPad=function(t,e){for(;t.length<e;)t="0"+t;return t},t.prototype.DateFormat=function(t){var e=this,r=x(t),n=this.sections[0],i=r.getUTCHours();return n.twelve_hour&&(i>12&&(i-=12),0===i&&(i=12)),{parts:n.prefix.map((function(t){if(t.flag===f.date_component_minutes)return"mm"===t.text?{text:e.ZeroPad(r.getUTCMinutes().toString(),2)}:{text:e.ZeroPad(r.getUTCMinutes().toString(),1)};if(t.flag===f.date_component){switch(t.text.toLowerCase()){case"am/pm":case"a/p":var n=t.text.split("/");return{text:r.getUTCHours()>12?n[1]:n[0]};case"mmmmm":return{text:d.date_components.long_months[r.getUTCMonth()][0]};case"mmmm":return"MMMM"===t.text?{text:d.date_components.long_months[r.getUTCMonth()].toUpperCase()}:{text:d.date_components.long_months[r.getUTCMonth()]};case"mmm":return"MMM"===t.text?{text:d.date_components.short_months[r.getUTCMonth()].toUpperCase()}:{text:d.date_components.short_months[r.getUTCMonth()]};case"mm":return{text:e.ZeroPad((r.getUTCMonth()+1).toString(),2)};case"m":return{text:e.ZeroPad((r.getUTCMonth()+1).toString(),1)};case"ddddd":case"dddd":return"DDDDD"===t.text||"DDDD"===t.text?{text:d.date_components.long_days[r.getUTCDay()].toUpperCase()}:{text:d.date_components.long_days[r.getUTCDay()]};case"ddd":return"DDD"===t.text?{text:d.date_components.short_days[r.getUTCDay()].toUpperCase()}:{text:d.date_components.short_days[r.getUTCDay()]};case"dd":return{text:e.ZeroPad(r.getUTCDate().toString(),2)};case"d":return{text:e.ZeroPad(r.getUTCDate().toString(),1)};case"yyyy":case"yyy":return{text:r.getUTCFullYear().toString()};case"yy":case"y":return{text:e.ZeroPad((r.getUTCFullYear()%100).toString(),2)};case"hh":return{text:e.ZeroPad(i.toString(),2)};case"h":return{text:e.ZeroPad(i.toString(),1)};case"ss":return{text:e.ZeroPad(r.getUTCSeconds().toString(),2)};case"s":return{text:e.ZeroPad(r.getUTCSeconds().toString(),1)}}var o=t.text.match(/^(s+)\.(0+)$/);if(o)return{text:e.ZeroPad(r.getUTCSeconds().toString(),o[1].length)+d.decimal_separator+(r.getUTCMilliseconds()/1e3).toFixed(o[2].length).substr(2)}}return y({},t)})),section:n}},t.prototype.StringFormat=function(t,e){for(var r=[],n=0,i=e.prefix;n<i.length;n++){var o=i[n];o.flag===f.literal?r.push({text:t}):r.push(y({},o))}return{parts:r,section:e}},t.prototype.Round2=function(t,e){var r=Math.pow(10,e);return Math.round(r*t)/r},t.prototype.FormatFraction=function(e,r){r.percent&&(e*=100);var n={denominator:1,numerator:Math.round(e),error:Math.abs(Math.round(e)-e)};if(r.fraction_denominator)n.denominator=r.fraction_denominator,n.numerator=Math.round(e*n.denominator);else if(n.error)for(var i=t.fraction_limits[r.fraction_denominator_digits-1]||t.fraction_limits[0],o=2;o<=i;o++){var a=Math.round(e*o),s=Math.abs(a/o-e);if(s<n.error&&(n={numerator:a,denominator:o,error:s},!s))break}var h=[];if(r.fraction_integer){var c=Math.floor(n.numerator/n.denominator);n.numerator%=n.denominator,!c&&n.numerator||(h.push(c.toString()),n.numerator&&h.push(" "))}else n.numerator||h.push("0");return n.numerator&&(h.push(n.numerator.toString()),h.push("/"),h.push(n.denominator.toString())),h.join("")},t.prototype.BaseFormat=function(e){if(this.sections[0].date_format)return this.DateFormat(Number(e));if("number"!=typeof e)return this.StringFormat(e.toString(),this.sections[3]);var r=this.sections[0],n=this.decimal_zero_regexp[0];e<0&&(r=this.sections[1]);var i=r.percent?r.decimal_max_digits+2:r.decimal_max_digits,o=Math.pow(10,-i)/2,a=Math.abs(e);if(a<o&&(r=this.sections[2],n=this.decimal_zero_regexp[2]),r.scaling&&(a/=r.scaling)<o&&(r=this.sections[2],n=this.decimal_zero_regexp[2]),r.string_format)return this.StringFormat(e.toString(),r);var s="";if(r.fraction_format)return{parts:[this.FormatFraction(a,r)],section:r};r.exponential?s=a.toExponential(r.decimal_max_digits):(r.percent&&(a*=100),s=this.Round2(a,r.decimal_max_digits).toFixed(r.decimal_max_digits)),n&&(s=s.replace(n,""));for(var h=s.split(".");h[0].length<r.integer_min_digits;)h[0]=("0000000000000000"+h[0]).slice(-r.integer_min_digits);return 0===r.integer_min_digits&&"0"===h[0]&&(h[0]=""),r.grouping&&(h[0]=h[0].replace(t.grouping_regexp,"$&"+d.grouping_separator)),{parts:h,section:r}},t.grouping_regexp=/\d{1,3}(?=(\d{3})+(?!\d))/g,t.fraction_limits=[9,99,999,9999],t.imaginary_character="𝑖",t.minus_character="-",t}(),S=function(){function t(){}return t.Get=function(t,e){if(void 0===e&&(e=!1),e&&"General"===t)return this.complex_general;var r=this.symbolc_name_map[t.toLowerCase()],n=this.cache[r||t];return n||(n=new C(t),this.cache[t]=n),n},t.Equals=function(t,e){if(t===e)return!0;var r=this.Get(t),n=this.Get(e);return r.pattern===n.pattern},t.Translate=function(t){var e=this.symbolc_name_map[t.toLowerCase()];return e?this.cache[e].toString():t},t.SymbolicName=function(t){for(var e=0,r=Object.keys(this.base_formats);e<r.length;e++){var n=r[e];if(t===this.base_formats[n])return n}return null},t.InitCache=function(){for(var t=0,e=Object.keys(this.base_formats);t<e.length;t++){var r=e[t];this.cache[r]=new C(this.base_formats[r]),this.symbolc_name_map[r.toLowerCase()]=r}this.cache.General.magic_decimal=!0,this.complex_general=new C("0.###"),this.complex_general.magic_decimal=!0;for(var n=0,i=Object.keys(this.aliases);n<i.length;n++)r=i[n],this.cache[r]=this.cache[this.aliases[r]],this.symbolc_name_map[r.toLowerCase()]=r},t.cache={},t.symbolc_name_map={},t.base_formats={Accounting:"_(#,##0.00_);(#,##0.00);-???",Number:"0.00",Integer:"0",Percent:"0.00%",General:"0.######",Fraction:"# ?/?",Dollar:"$* _(#,##0.00_);$* (#,##0.00);$* -???",Exponential:"0.000e","Short Date":"mm/dd/yy","Long Date":"dddd, mmm d yyyy",Timestamp:"mm-dd-yy hh:mm:ss"},t.aliases={Scientific:"Exponential",Percentage:"Percent",Currency:"Dollar"},t}();S.InitCache(),function(t){t[t.None=0]="None",t[t.Nan=1]="Nan",t[t.Exponential=2]="Exponential",t[t.Percent=4]="Percent",t[t.Currency=8]="Currency",t[t.Grouping=16]="Grouping",t[t.Parens=32]="Parens",t[t.Date=64]="Date",t[t.Time=128]="Time"}(g||(g={}));var T=(new Date).getUTCFullYear(),M=new(function(){function t(){}return t.prototype.TestDate=function(t){var e=Date.parse(t);if(isNaN(e))return!1;var r=new Date(e),n=t.replace(/[\d\-\\/,.\s]+/g," ").toLocaleLowerCase().split(/\s+/).map((function(t){return t.trim()})).filter((function(t){return!!t}));if(!n.length)return e;if(!this.compare_month){this.compare_month={};for(var i=0;i<12;i++)this.compare_month[d.date_components.long_months[i].toLocaleLowerCase().replace(/\./,"")]=i,this.compare_month[d.date_components.short_months[i].toLocaleLowerCase().replace(/\./,"")]=i}if(!this.compare_day)for(this.compare_day={},i=0;i<7;i++)this.compare_day[d.date_components.long_days[i].toLocaleLowerCase().replace(/\./,"")]=i,this.compare_day[d.date_components.short_days[i].toLocaleLowerCase().replace(/\./,"")]=i;for(var o=!1,a=!1,s=0,h=n;s<h.length;s++){for(var c=h[s],u=!1,l=0,p=Object.entries(this.compare_month);l<p.length;l++){var f=p[l],m=f[0],_=f[1];if(c===m){if(o)return!1;if(r.getUTCMonth()!==_)return!1;u=!0,o=!0}}if(!u)for(var g=0,v=Object.entries(this.compare_day);g<v.length;g++){var y=v[g],w=y[0];if(_=y[1],c===w){if(a)return!1;if(r.getUTCDay()!==_)return!1;u=!0,a=!0}}if(!u)return!1}return!(a&&!o)&&e},t.prototype.TryParse=function(t){void 0===t&&(t="");var e=g.None;if("'"===t[0])return{value:t,type:r.string};if(""===t)return{value:t,type:r.string};if("NaN"===t)return{value:NaN,type:r.number,hints:g.Nan};var n=t.trim(),i=n.match(/^[$](.*?)$/);i&&(n=i[1],e|=g.Currency);var o=n.match(/^\((.*?)\)$/);o&&(n=o[1],e|=g.Parens);var a=n.match(/^(.*?)%\s*$/);a&&(n=a[1],e|=g.Percent),"."===d.decimal_separator?/,/.test(n)&&(n=n.replace(/,/g,""),e|=g.Grouping):n=(n=(n=n.replace(/(\d)\s+/g,"$1")).replace(/\./g,"")).replace(/,/,".");var s=Number(n);if(null===s||isNaN(s)){var h=t.toLowerCase();if("false"===h)return{value:!1,type:r.boolean};if("true"===h)return{value:!0,type:r.boolean};var c=this.TestDate(t);if(!1!==c&&!isNaN(c)){var u=new Date(c),l=u.getUTCFullYear();if(l>=T-200&&l<=T+200)return e=g.Date,(u.getHours()||u.getMinutes()||u.getSeconds())&&(e|=g.Time),{value:b(c),type:r.number,hints:e}}return{value:t,type:r.string}}if(o&&(s=-s),a){var p=s<0?-1:1,f=(p*s).toString().split(".");f[0]=("00"+f[0]).replace(/(\d\d)$/,".$1"),s=Number(f.join(""))*p}return/e/.test(t)&&(e|=g.Exponential),{value:s,type:r.number,hints:e}},t}());return e})()}));