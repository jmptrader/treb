/*! v13.1.3. Copyright 2018-2021 Structured Data, LLC. All rights reserved. CC BY-ND: https://treb.app/license */
var t={548:(t,e,r)=>{r.r(e)}},e={};function r(a){var i=e[a];if(void 0!==i)return i.exports;var n=e[a]={exports:{}};return t[a](n,n.exports,r),n.exports}r.d=(t,e)=>{for(var a in e)r.o(e,a)&&!r.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var a={};(()=>{r.d(a,{xu:()=>g,kL:()=>E,WH:()=>d,y4:()=>C,FJ:()=>M,Ci:()=>j,Zr:()=>N,YU:()=>T});var t,e,i=function(){this.date_format=!1,this.string_format=!1,this.fraction_format=!1,this.twelve_hour=!1,this.fraction_denominator=0,this.fraction_integer=!0,this.fraction_align=0,this.fraction_denominator_digits=0,this.integer_min_digits=0,this.decimal_min_digits=0,this.decimal_max_digits=0,this.grouping=!1,this.has_number_format=!1,this.prefix=[{text:""}],this.suffix=[{text:""}],this.scaling=0,this.percent=!1,this.exponential=!1,this.has_asterisk=!1},n=function(){return n=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},n.apply(this,arguments)},o=function(){function t(t,e,r){void 0===e&&(e=t),void 0===r&&(r=!1),this.end_=this.PatchNull(e),this.start_=this.PatchNull(t),r&&this.Normalize()}return t.FromColumn=function(e){return new t({row:1/0,column:e})},t.FromRow=function(e){return new t({row:e,column:1/0})},t.ColumnToLabel=function(t){for(var e=String.fromCharCode(65+t%26);t>25;)t=Math.floor(t/26)-1,e=String.fromCharCode(65+t%26)+e;return e},t.CellAddressToLabel=function(t,e){return void 0===e&&(e=!1),(e?(t.sheet_id||0)+"!":"")+(t.absolute_column?"$":"")+this.ColumnToLabel(t.column)+(t.absolute_row?"$":"")+(t.row+1)},t.Join=function(e){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];for(var i=new t(e.start,e.end),n=0,o=r;n<o.length;n++){var s=o[n];s&&(i.ConsumeAddress(s.start),i.ConsumeAddress(s.end))}return i},t.Bleed=function(e,r){return void 0===r&&(r=1),new t({row:Math.max(0,e.start.row-r),column:Math.max(0,e.start.column-r)},{row:e.end.row+r,column:e.end.column+r})},Object.defineProperty(t.prototype,"start",{get:function(){return n({},this.start_)},set:function(t){this.start_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return n({},this.end_)},set:function(t){this.end_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){return this.start_.row===1/0||this.end_.row===1/0?1/0:this.end_.row-this.start_.row+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"columns",{get:function(){return this.start_.column===1/0||this.end_.column===1/0?1/0:this.end_.column-this.start_.column+1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"count",{get:function(){return this.rows*this.columns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_sheet",{get:function(){return this.entire_row&&this.entire_column},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_column",{get:function(){return this.start_.row===1/0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"entire_row",{get:function(){return this.start_.column===1/0},enumerable:!1,configurable:!0}),t.prototype.PatchNull=function(t){var e=n({},t);return null===e.row&&(e.row=1/0),null===e.column&&(e.column=1/0),e},t.prototype.SetSheetID=function(t){this.start_.sheet_id=t},t.prototype.Normalize=function(){var t=n({},this.start_),e=n({},this.end_);t.row===1/0||e.row===1/0?t.row=e.row=1/0:t.row>e.row&&(t.row=this.end_.row,t.absolute_row=this.end_.absolute_row,e.row=this.start_.row,e.absolute_row=this.start_.absolute_row),t.column===1/0||e.column===1/0?t.column=e.column=1/0:t.column>e.column&&(t.column=this.end_.column,t.absolute_column=this.end_.absolute_column,e.column=this.start_.column,e.absolute_column=this.start_.absolute_column),this.start_=t,this.end_=e},t.prototype.TopLeft=function(){var t={row:0,column:0};return this.entire_row||(t.column=this.start.column),this.entire_column||(t.row=this.start.row),t},t.prototype.BottomRight=function(){var t={row:0,column:0};return this.entire_row||(t.column=this.end.column),this.entire_column||(t.row=this.end.row),t},t.prototype.ContainsRow=function(t){return this.entire_column||t>=this.start_.row&&t<=this.end_.row},t.prototype.ContainsColumn=function(t){return this.entire_row||t>=this.start_.column&&t<=this.end_.column},t.prototype.Contains=function(t){return(this.entire_column||t.row>=this.start_.row&&t.row<=this.end_.row)&&(this.entire_row||t.column>=this.start_.column&&t.column<=this.end_.column)},t.prototype.ContainsArea=function(t){return this.start.column<=t.start.column&&this.end.column>=t.end.column&&this.start.row<=t.start.row&&this.end.row>=t.end.row},t.prototype.Intersects=function(t){return!(t.start.column>this.end.column||this.start.column>t.end.column||t.start.row>this.end.row||this.start.row>t.end.row)},t.prototype.Equals=function(t){return t.start_.row===this.start_.row&&t.start_.column===this.start_.column&&t.end_.row===this.end_.row&&t.end_.column===this.end_.column},t.prototype.Clone=function(){return new t(this.start,this.end)},t.prototype.Array=function(){if(this.entire_column||this.entire_row)throw new Error("can't convert infinite area to array");for(var t=new Array(this.rows*this.columns),e=this.start_.sheet_id,r=0,a=this.start_.row;a<=this.end_.row;a++)for(var i=this.start_.column;i<=this.end_.column;i++)t[r++]={row:a,column:i,sheet_id:e};return t},Object.defineProperty(t.prototype,"left",{get:function(){var e=new t(this.start_,this.end_);return e.end_.column=e.start_.column,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){var e=new t(this.start_,this.end_);return e.start_.column=e.end_.column,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){var e=new t(this.start_,this.end_);return e.end_.row=e.start_.row,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){var e=new t(this.start_,this.end_);return e.start_.row=e.end_.row,e},enumerable:!1,configurable:!0}),t.prototype.Shift=function(t,e){return this.start_.row+=t,this.start_.column+=e,this.end_.row+=t,this.end_.column+=e,this},t.prototype.ConsumeAddress=function(t){this.entire_row||(t.column<this.start_.column&&(this.start_.column=t.column),t.column>this.end_.column&&(this.end_.column=t.column)),this.entire_column||(t.row<this.start_.row&&(this.start_.row=t.row),t.row>this.end_.row&&(this.end_.row=t.row))},t.prototype.ConsumeArea=function(t){this.ConsumeAddress(t.start),this.ConsumeAddress(t.end)},t.prototype.Resize=function(t,e){return this.end_.row=this.start_.row+t-1,this.end_.column=this.start_.column+e-1,this},t.prototype.Iterate=function(t){if(this.entire_column||this.entire_row)console.warn("don't iterate infinite area");else for(var e=this.start_.column;e<=this.end_.column;e++)for(var r=this.start_.row;r<=this.end_.row;r++)t({column:e,row:r,sheet_id:this.start_.sheet_id})},Object.defineProperty(t.prototype,"spreadsheet_label",{get:function(){var e;return this.entire_sheet?"":this.entire_column?(e=t.ColumnToLabel(this.start_.column),e+=":"+t.ColumnToLabel(this.end_.column)):this.entire_row?(e=String(this.start_.row+1),e+=":"+(this.end_.row+1)):(e=t.CellAddressToLabel(this.start_),this.columns>1||this.rows>1?e+":"+t.CellAddressToLabel(this.end_):e)},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{start:n({},this.start_),end:n({},this.end_)}},t}();(e=t||(t={}))[e[void 0]=0]="undefined",e[e.formula=1]="formula",e[e.string=2]="string",e[e.number=3]="number",e[e.boolean=4]="boolean",e[e.object=5]="object",e[e.error=6]="error",e[e.complex=7]="complex",e[e.array=8]="array";var s,h=function(e){switch(typeof e){case"undefined":return t.undefined;case"number":return t.number;case"boolean":return t.boolean;case"object":return null===e?t.undefined:function(t){return"object"==typeof t&&!!t&&"number"==typeof t.real&&"number"==typeof t.imaginary}(e)?t.complex:t.object;case"string":return"="===e[0]?t.formula:t.string;default:return t.error}};!function(t){t[t.List=0]="List",t[t.Date=1]="Date",t[t.Range=2]="Range",t[t.Number=3]="Number",t[t.Boolean=4]="Boolean"}(s||(s={}));var l=function(){function e(e,r){this.type=t.undefined,this.render_dirty=!0,void 0!==e&&this.Set(e,r)}return e.StringToColumn=function(t){var e=0;t=t.toUpperCase();for(var r=0;r<t.length;r++)e*=26,e+=t.charCodeAt(r)-64;return e-1},e.prototype.ValueIsNumber=function(){return this.type===t.number},e.prototype.ValueIsFormula=function(){return this.type===t.formula},e.prototype.ValueIsBoolean=function(){return this.type===t.boolean},e.prototype.ValueIsComplex=function(){return this.type===t.complex},e.prototype.FlushStyle=function(){this.formatted=this.rendered_type=this.style=void 0,this.render_dirty=!0},e.prototype.FlushArray=function(){this.area=void 0},e.prototype.FlushCache=function(){this.calculated=this.calculated_type=this.formatted=this.rendered_type=this.render_function=this.click_function=void 0,this.render_dirty=!0},e.prototype.Reset=function(){this.type=t.undefined,this.value=this.note=this.hyperlink=this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=this.area=this.renderer_data=this.render_function=this.click_function=void 0,this.render_dirty=!0},e.prototype.Set=function(t,e){void 0===e&&(e=h(t)),this.value=t,this.type=e,this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=this.render_function=this.click_function=this.area=void 0,this.render_dirty=!0},e.prototype.SetCalculatedValue=function(t,e){void 0===e&&(e=h(t)),this.calculated!==t&&(this.calculated=t,this.calculated_type=e,this.formatted=this.rendered_type=void 0,this.render_dirty=!0)},e.prototype.SetCalculatedValueOrError=function(e,r){void 0===r&&("object"==typeof e&&e.error?(r=t.error,e=e.error):r=h(e)),this.calculated!==e&&(this.calculated=e,this.calculated_type=r,this.formatted=this.rendered_type=void 0,this.render_dirty=!0)},e.prototype.GetValue=function(){return this.calculated_type?this.calculated:"string"==typeof this.value&&"'"===this.value[0]?this.value.slice(1):this.value},e.prototype.GetValue4=function(){return this.calculated_type?{type:this.calculated_type,value:this.calculated}:this.type===t.formula?{type:t.number,value:0}:{type:this.type,value:"string"==typeof this.value&&"'"===this.value[0]?this.value.slice(1):this.value}},e.prototype.SetNote=function(t){this.note=t,this.render_dirty=!0},e.prototype.SetCalculationError=function(e){void 0===e&&(e="ERR"),this.SetCalculatedValue(e,t.error)},e.prototype.SetArray=function(e){this.type=t.undefined,this.value=this.formatted=this.rendered_type=this.style=this.hyperlink=this.calculated=this.calculated_type=void 0,this.area=e,this.render_dirty=!0},e.prototype.SetArrayHead=function(t,e){this.type=h(e),this.value=e,this.formatted=this.rendered_type=this.style=this.calculated=this.calculated_type=void 0,this.area=t,this.render_dirty=!0},e}(),c=function(){return c=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},c.apply(this,arguments)},u=function(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(t);i<a.length;i++)e.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(t,a[i])&&(r[a[i]]=t[a[i]])}return r},d=(function(){function e(){this.data=[],this.rows_=0,this.columns_=0}Object.defineProperty(e.prototype,"rows",{get:function(){return this.rows_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columns",{get:function(){return this.columns_},enumerable:!1,configurable:!0}),e.prototype.EnsureRow=function(t){this.rows_=Math.max(t+1,this.rows_)},e.prototype.EnsureColumn=function(t){this.columns_=Math.max(t+1,this.columns_)},e.prototype.InsertColumns=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1),this.data=this.data.map((function(r){if(r.length>=t){var a=r.slice(0,t),i=t+e;return r.slice(t).forEach((function(t){return a[i++]=t})),a}return r})),this.columns_+=e},e.prototype.DeleteColumns=function(t,e){void 0===e&&(e=1),this.data.forEach((function(r){return r.splice(t,e)})),this.columns_-=e},e.prototype.DeleteRows=function(t,e){void 0===e&&(e=1),this.data.splice(t,e),this.rows_-=e},e.prototype.InsertRows=function(t,e){void 0===t&&(t=0),void 0===e&&(e=1);for(var r=[t,0,[]],a=1;a<e;a++)r.push([]);Array.prototype.splice.apply(this.data,r),this.rows_+=e},e.prototype.GetCell=function(t,e){var r=t.row,a=t.column;if(!this.data[r]){if(!e)return;this.data[r]=[],this.rows_=Math.max(this.rows_,r+1)}return this.data[r][a]||e&&(this.data[r][a]=new l,this.columns_=Math.max(this.columns_,a+1)),this.data[r][a]},e.prototype.EnsureCell=function(t){var e=t.row,r=t.column,a=this.data[e];a||(this.data[e]=a=[],this.rows_=Math.max(this.rows_,e+1));var i=a[r];return i||(i=a[r]=new l,this.columns_=Math.max(this.columns_,r+1)),i},e.prototype.FromArray=function(t,e){void 0===t&&(t=[]),void 0===e&&(e=!1),this.data=[];var r=0,a=0;if(e){a=t.length;for(var i=0;i<a;i++){var n=t[i];r=Math.max(r,n.length);for(var o=0;o<n.length;o++)this.data[o]||(this.data[o]=[]),this.data[o][i]=new l(n[o])}}else for(r=t.length,o=0;o<r;o++){var s=[];for(n=t[o],a=Math.max(a,n.length),i=0;i<n.length;i++)s[i]=new l(n[i]);this.data[o]=s}this.rows_=r,this.columns_=a},e.prototype.FromJSON=function(t,e){if(void 0===t&&(t=[]),this.data=[],!(_=t)[0]||!function(t){return!t.cells}(_[0])){var r=[];if(function(t){return!!t[0]&&void 0!==t[0].row}(t))for(var a=0,i=t;a<i.length;a++)for(var n=0,s=(p=i[a]).cells;n<s.length;n++){var h=s[n];r.push(c(c({},h),{row:p.row}))}else for(var u=0,d=t;u<d.length;u++)for(var p,m=0,f=(p=d[u]).cells;m<f.length;m++)h=f[m],r.push(c(c({},h),{column:p.column}));t=r}for(var _,g=0,v=t;g<v.length;g++){var y=v[g];if(this.data[y.row]||(this.data[y.row]=[]),h=new l(y.value),void 0!==y.calculated&&h.SetCalculatedValue(y.calculated,y.calculated_type),e&&void 0!==y.style_ref&&(h.style=e[y.style_ref]),void 0!==y.note&&(h.note=y.note),void 0!==y.hyperlink&&(h.hyperlink=y.hyperlink),this.data[y.row][y.column]&&this.data[y.row][y.column].area&&(h.area=this.data[y.row][y.column].area),this.data[y.row][y.column]=h,y.area)for(var x=new o(y.area.start,y.area.end),b=x.start.row;b<=x.end.row;b++)for(var w=x.start.column;w<=x.end.column;w++)this.data[b]||(this.data[b]=[]),this.data[b][w]||(this.data[b][w]=new l),this.data[b][w].area=x;if(y.merge_area){var C=new o(y.merge_area.start,y.merge_area.end);for(b=C.start.row;b<=C.end.row;b++)for(w=C.start.column;w<=C.end.column;w++)this.data[b]||(this.data[b]=[]),this.data[b][w]||(this.data[b][w]=new l),this.data[b][w].merge_area=C}y.validation&&(h.validation=y.validation)}this.rows_=this.data.length,this.columns_=this.data.reduce((function(t,e){return Math.max(t,e.length)}),0)},e.prototype.toJSON=function(e){void 0===e&&(e={});var r,a=0,i=0,n=this.data.length-1;e.subset&&(a=e.subset.start.column,i=e.subset.start.row,n=e.subset.end.row);for(var o=[],s=-1,h=-1,l={},c={},d=i;d<=n;d++)if(this.data[d]){var p=this.data[d];r=p.length-1,e.subset&&(r=e.subset.end.column);for(var m=a;m<=r;m++){var f=p[m],_=f&&f.merge_area&&f.merge_area.start.row===d&&f.merge_area.start.column===m,g=f&&f.area&&f.area.start.row===d&&f.area.start.column===m,v=!f||f.type===t.string&&!f.value;if(f&&(!v||e.preserve_empty_strings)&&(_||f.type||f.calculated_type&&e.expand_arrays||f.calculated_type&&e.calculated_value||f.validation||e.decorated_cells&&f.style&&(f.style.fill||f.style.border_bottom||f.style.border_top||f.style.border_left||f.style.border_right))){var y={row:d,column:m,value:f.value};f.note&&(y.note=f.note),f.hyperlink&&(y.hyperlink=f.hyperlink),e.preserve_type&&(y.type=f.type),e.sheet_id&&(y.sheet_id=e.sheet_id),e.calculated_value&&void 0!==f.calculated&&(y.calculated=f.calculated,(e.preserve_type||f.calculated_type===t.error)&&(y.calculated_type=f.calculated_type)),f.area&&g&&(y.area=f.area.toJSON()),f.merge_area&&(y.merge_area=f.merge_area.toJSON()),f.validation&&(y.validation=f.validation),e.cell_style_refs&&e.cell_style_refs[m]&&e.cell_style_refs[m][d]&&(y.style_ref=e.cell_style_refs[m][d],e.cell_style_refs[m][d]=0),l[d]=d,c[m]=m,s=Math.max(d,s),h=Math.max(m,h),o.push(y)}}}if(e.nested){var x=Object.keys(l),b=Object.keys(c);if(x.length<=b.length&&x.length){for(var w={},C=[],M=0,S=o;M<S.length;M++){d=(D=S[M]).row;var A=u(D,["row"]);w[D.row]||(w[D.row]=[]),w[D.row].push(A)}for(var k=0,P=x;k<P.length;k++){var T=P[k];d=Number(T),C.push({row:d,cells:w[d]})}return{data:C,rows:s,columns:h+1}}if(b.length){w={},C=[];for(var R=0,L=o;R<L.length;R++){var D;m=(D=L[R]).column,A=u(D,["column"]),w[D.column]||(w[D.column]=[]),w[D.column].push(A)}for(var F=0,z=b;F<z.length;F++)T=z[F],m=Number(T),C.push({column:m,cells:w[m]});return{data:C,rows:s,columns:h+1}}}return{data:o,rows:s+1,columns:h+1}},e.prototype.GetAll=function(t){return void 0===t&&(t=!1),this.GetRange({row:0,column:0},{row:this.rows_-1,column:this.columns_-1},t)},e.prototype.Normalize2=function(t,e){return t.column===1/0&&(t=c(c({},t),{column:0})),t.row===1/0&&(t=c(c({},t),{row:0})),e.column===1/0&&(e=c(c({},e),{column:this.columns_-1})),e.row===1/0&&(e=c(c({},e),{row:this.rows_-1})),{from:t,to:e}},e.prototype.Normalize1=function(t){return t.column===1/0&&(t=c(c({},t),{column:0})),t.row===1/0&&(t=c(c({},t),{row:0})),t},e.prototype.RawValue=function(t,e){var r;if(void 0===e&&(e=t),t=(r=this.Normalize2(t,e)).from,e=r.to,t.row===e.row&&t.column===e.column)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].value:void 0;for(var a=[],i=this.data.slice(t.row,e.row+1),n=t.column,o=e.column+1,s=0,h=i;s<h.length;s++){for(var l=h[s],c=[],u=n,d=0;u<o;u++,d++){var p=l[u];c.push(p?p.value:void 0)}a.push(c)}return a},e.prototype.GetRange=function(t,e,r){var a;if(void 0===r&&(r=!1),e?(t=(a=this.Normalize2(t,e)).from,e=a.to):t=this.Normalize1(t),!e||t===e||t.column===e.column&&t.row===e.row)return this.data[t.row]&&this.data[t.row][t.column]?this.data[t.row][t.column].GetValue():void 0;var i=[];if(r)for(var n=t.column;n<=e.column;n++){for(var o=[],s=t.row;s<=e.row;s++)this.data[s]&&this.data[s][n]?o.push(this.data[s][n].GetValue()):o.push(void 0);i.push(o)}else for(s=t.row;s<=e.row;s++){var h=[];for(n=t.column;n<=e.column;n++)this.data[s]&&this.data[s][n]?h.push(this.data[s][n].GetValue()):h.push(void 0);i.push(h)}return i},e.prototype.GetRange4=function(e,r,a){var i;if(void 0===r&&(r=e),void 0===a&&(a=!1),e=(i=this.Normalize2(e,r)).from,r=i.to,e.row===r.row&&e.column===r.column)return this.data[e.row]&&this.data[e.row][e.column]?this.data[e.row][e.column].GetValue4():{value:void 0,type:t.undefined};var n=[];if(a)for(var o=e.column;o<=r.column;o++){for(var s=[],h=e.row;h<=r.row;h++)this.data[h]&&this.data[h][o]?s.push(this.data[h][o].GetValue4()):s.push({type:t.undefined});n.push(s)}else for(h=e.row;h<=r.row;h++){var l=[];for(o=e.column;o<=r.column;o++)this.data[h]&&this.data[h][o]?l.push(this.data[h][o].GetValue4()):l.push({type:t.undefined});n.push(l)}return{type:t.array,value:n}},e.prototype.Apply=function(t,e,r){var a;if(void 0===r&&(r=!1),"object"==typeof(a=t)&&void 0!==a.row&&void 0!==a.column&&(t=new o(t)),t.entire_column||t.entire_row)throw new Error("don't iterate infinite cells");var i=t.start,n=t.end;if(r)for(var s=i.row;s<=n.row;s++){this.data[s]||(this.data[s]=[]);for(var h=this.data[s],c=i.column;c<=n.column;c++)h[c]||(h[c]=new l),e(h[c],c,s)}else for(s=i.row;s<=n.row;s++)if(this.data[s])for(h=this.data[s],c=i.column;c<=n.column;c++)h[c]&&e(h[c],c,s)},e.prototype.SetArea=function(t,e){if(ArrayBuffer.isView(e))throw new Error("ABIV");if(Array.isArray(e))for(var r=t.start.row,a=0;r<=t.end.row;r++,a++){this.data[r]||(this.data[r]=[]);var i=this.data[r];if(e[a])for(var n=t.start.column,o=0;n<=t.end.column;n++,o++)i[n]||(i[n]=new l),i[n].Set(e[a][o])}else{var s=h(e);for(r=t.start.row;r<=t.end.row;r++)for(this.data[r]||(this.data[r]=[]),i=this.data[r],n=t.start.column;n<=t.end.column;n++)i[n]||(i[n]=new l),i[n].Set(e,s)}this.rows_=Math.max(this.rows_,t.end.row+1),this.columns_=Math.max(this.columns_,t.end.column+1)},e.prototype.IterateAll=function(t){for(var e=0,r=this.data;e<r.length;e++){var a=r[e];if(a)for(var i=0,n=a;i<n.length;i++){var o=n[i];o&&t(o)}}},e.prototype.FlushCellStyles=function(){for(var t=0,e=this.data;t<e.length;t++){var r=e[t];if(r)for(var a=0,i=r;a<i.length;a++){var n=i[a];n&&n.FlushStyle()}}},e.prototype.FlushCachedValues=function(){for(var t=0,e=this.data;t<e.length;t++){var r=e[t];if(r)for(var a=0,i=r;a<i.length;a++){var n=i[a];n&&n.FlushCache()}}}}(),function(){function t(){}return t.UpdateLocale=function(t){var e;if(t)this.locale=t;else if("undefined"!=typeof self){var r=null===(e=null===self||void 0===self?void 0:self.document)||void 0===e?void 0:e.location;if(r&&r.search&&/locale=([^?&]+?)(?:\?|$|&)/.test(r.search)){var a=r.search.match(/locale=(.*?)(?:\?|$|&)/);a&&(this.locale=a[1]),console.info("override locale",this.locale)}else"undefined"!=typeof navigator&&(navigator.languages&&navigator.languages[0]?this.locale=navigator.languages[0]:this.locale=navigator.language)}var i=new Intl.NumberFormat(this.locale,{minimumFractionDigits:1}).format(3.3).replace(/\d/g,"");this.decimal_separator=","===i?",":".",","===this.decimal_separator?(this.argument_separator=";",this.grouping_separator=" "):(this.argument_separator=",",this.grouping_separator=",");var n=new Date(2e3,0,2,12,0,0,0);this.UpdateDateComponent(0,0,n),n=new Date(2e3,1,7,12,0,0,0),this.UpdateDateComponent(1,1,n),n=new Date(2e3,2,7,12,0,0,0),this.UpdateDateComponent(2,2,n),n=new Date(2e3,3,5,12,0,0,0),this.UpdateDateComponent(3,3,n),n=new Date(2e3,4,4,12,0,0,0),this.UpdateDateComponent(4,4,n),n=new Date(2e3,5,2,12,0,0,0),this.UpdateDateComponent(5,5,n),n=new Date(2e3,6,1,12,0,0,0),this.UpdateDateComponent(6,6,n),n=new Date(2e3,7,1,12,0,0,0),this.UpdateDateComponent(7,-1,n),n=new Date(2e3,8,1,12,0,0,0),this.UpdateDateComponent(8,-1,n),n=new Date(2e3,9,1,12,0,0,0),this.UpdateDateComponent(9,-1,n),n=new Date(2e3,10,1,12,0,0,0),this.UpdateDateComponent(10,-1,n),n=new Date(2e3,11,1,12,0,0,0),this.UpdateDateComponent(11,-1,n)},t.UpdateDateComponent=function(t,e,r){e>=0&&(this.date_components.short_days[e]=r.toLocaleString(this.locale,{weekday:"short"}),this.date_components.long_days[e]=r.toLocaleString(this.locale,{weekday:"long"})),t>=0&&(this.date_components.short_months[t]=r.toLocaleString(this.locale,{month:"short"}),this.date_components.long_months[t]=r.toLocaleString(this.locale,{month:"long"}))},t.locale="en-us",t.decimal_separator=".",t.argument_separator=",",t.grouping_separator=",",t.date_components={short_days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],long_days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],short_months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],long_months:["January","February","March","April","May","June","July","August","September","October","November","December"]},t}());d.UpdateLocale(),function(){function t(t,e,r,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===a&&(a=0),this.left=t,this.top=e,this.width=r,this.height=a}Object.defineProperty(t.prototype,"right",{get:function(){return this.left+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.top+this.height},enumerable:!1,configurable:!0}),t.Create=function(e){return new t(e.left||0,e.top||0,e.width||0,e.height||0)},t.IsRectangle=function(t){var e,r,a,i;return"object"==typeof t&&"number"==typeof(null===(e=t)||void 0===e?void 0:e.left)&&"number"==typeof(null===(r=t)||void 0===r?void 0:r.top)&&"number"==typeof(null===(a=t)||void 0===a?void 0:a.width)&&"number"==typeof(null===(i=t)||void 0===i?void 0:i.height)},t.prototype.Shift=function(e,r){return void 0===e&&(e=0),void 0===r&&(r=0),new t(this.left+e,this.top+r,this.width,this.height)},t.prototype.Scale=function(e,r){return void 0===e&&(e=1),void 0===r&&(r=e),new t(this.left*e,this.top*r,this.width*e,this.height*r)},t.prototype.Expand=function(e,r){return void 0===e&&(e=0),void 0===r&&(r=0),new t(this.left,this.top,this.width+e,this.height+r)},t.prototype.Combine=function(e){return new t(Math.min(this.left,e.left),Math.min(this.top,e.top),Math.max(this.right,e.right)-Math.min(this.left,e.left),Math.max(this.bottom,e.bottom)-Math.min(this.top,e.top))},t.prototype.CheckEdges=function(t,e,r){void 0===r&&(r=16);var a=0;return t-this.left<r&&(a|=1),this.right-t<r&&(a|=2),e-this.top<r&&(a|=4),this.bottom-e<r&&(a|=8),a},t.prototype.Contains=function(t,e,r){return void 0===r&&(r=0),t>=this.left-r&&t<=this.left+this.width+r&&e>=this.top-r&&e<=this.top+this.height+r},t.prototype.ContextFill=function(t){t.fillRect(this.left,this.top,this.width,this.height)},t.prototype.ContextStroke=function(t){t.strokeRect(this.left,this.top,this.width,this.height)},t.prototype.Clamp=function(t,e){return{x:t=Math.min(Math.max(t,this.left),this.right),y:e=Math.min(Math.max(e,this.top),this.bottom)}},t.prototype.ApplyStyle=function(t){t.style.top=this.top+"px",t.style.left=this.left+"px",t.style.width=this.width+"px",t.style.height=this.height+"px"},t.prototype.toJSON=function(){return{top:this.top,left:this.left,width:this.width,height:this.height}}}();var p,m,f=function(){return f=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},f.apply(this,arguments)};!function(t){var e,r,a=JSON.stringify({});!function(t){t[t.None=0]="None",t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=3]="Right"}(e=t.HorizontalAlign||(t.HorizontalAlign={})),function(t){t[t.None=0]="None",t[t.Top=1]="Top",t[t.Bottom=2]="Bottom",t[t.Middle=3]="Middle"}(r=t.VerticalAlign||(t.VerticalAlign={})),t.DefaultProperties={horizontal_align:e.None,vertical_align:r.None,number_format:"General",nan:"NaN",font_size:{unit:"pt",value:10},font_face:"calibri",bold:!1,italic:!1,underline:!1,strike:!1,text:{theme:1},border_top:0,border_left:0,border_right:0,border_bottom:0},t.CompositeBorders=function(t){return{top:{width:t.border_top||0,color:t.border_top_fill||{}},left:{width:t.border_left||0,color:t.border_left_fill||{}},right:{width:t.border_right||0,color:t.border_right_fill||{}},bottom:{width:t.border_bottom||0,color:t.border_bottom_fill||{}}}},t.Merge=function(t,e,r){void 0===r&&(r=!0);var a=f(r?f({},t):{},e);return JSON.parse(JSON.stringify(a))},t.Composite=function(t){return JSON.parse(JSON.stringify(t.reduce((function(t,e){return f(f({},t),e)}),{})))},t.Empty=function(t){return JSON.stringify(t)===a},t.ValidColor=function(t){return!(!t||t.none||!t.text&&!t.theme&&0!==t.theme)},t.ParseFontSize=function(t,e){void 0===t&&(t=""),void 0===e&&(e="em");var r=t.match(/(-*[\d.]+)\s*(\S*)/);if(r){var a=Number(r[1]);if(!a||isNaN(a)||a<0)return{};var i=r[2].toLowerCase()||e;if("pt"===i||"em"===i||"%"===i||"px"===i)return{font_size:{unit:i,value:a}}}return{}},t.RelativeFontSize=function(t,e){var r,a,i=12,n=12;switch(null===(r=t.font_size)||void 0===r?void 0:r.unit){case"pt":if(!t.font_size.value)return 1;n=t.font_size.value;break;case"px":if(!t.font_size.value)return 1;n=Math.round(300*t.font_size.value/4)/100;break;case"em":return t.font_size.value||1;case"%":return(t.font_size.value||100)/100;default:return 1}switch(null===(a=e.font_size)||void 0===a?void 0:a.unit){case"pt":if(!e.font_size.value)return 1;i=e.font_size.value;break;case"px":if(!e.font_size.value)return 1;i=Math.round(300*e.font_size.value/4)/100;break;default:return 1}return n/i},t.FontSize=function(t,e){var r,a;void 0===e&&(e=!0);var i=null===(r=t.font_size)||void 0===r?void 0:r.value;switch(null===(a=t.font_size)||void 0===a?void 0:a.unit){case"pt":return(i||12)+"pt";case"px":return e?Math.round(300*(i||16)/4)/100+"pt":(i||16)+"px";case"em":return(i||1)+"em";case"%":return(i||100)+"%"}return""},t.Font=function(t,e){var r,a;void 0===e&&(e=1);var i=[];return t.bold&&i.push("bold"),t.italic&&i.push("italic"),i.push((((null===(r=t.font_size)||void 0===r?void 0:r.value)||0)*e).toFixed(2)+((null===(a=t.font_size)||void 0===a?void 0:a.unit)||"pt")),i.push(t.font_face||""),i.join(" ")}}(p||(p={})),function(t){t[t.default=0]="default",t[t.hidden=1]="hidden",t[t.padded=2]="padded",t[t.date_component=3]="date_component",t[t.date_component_minutes=4]="date_component_minutes",t[t.literal=5]="literal",t[t.formatting=6]="formatting"}(m||(m={}));var _,g=function(t,e){return void 0===e&&(e=h(t)),{value:t,type:e}};new(function(){function t(){}return t.prototype.Darken=function(t,e,r,a,i){void 0===i&&(i=!1);var n=this.RGBToHSL(t,e,r),o=n.h,s=n.s,h=n.l;return h-=i?h*a/100:a/100,h=Math.max(0,Math.min(1,h)),this.HSLToRGB(o,s,h)},t.prototype.Lighten=function(t,e,r,a,i){void 0===i&&(i=!1);var n=this.RGBToHSL(t,e,r),o=n.h,s=n.s,h=n.l;return h+=i?h*a/100:a/100,h=Math.max(0,Math.min(1,h)),this.HSLToRGB(o,s,h)},t.prototype.RGBToHSL=function(t,e,r){t/=255,e/=255,r/=255;var a=Math.max(t,e,r),i=Math.min(t,e,r),n=0,o=0,s=(a+i)/2;if(a===i)n=o=0;else{var h=a-i;switch(o=s>.5?h/(2-a-i):h/(a+i),a){case t:n=(e-r)/h+(e<r?6:0);break;case e:n=(r-t)/h+2;break;case r:n=(t-e)/h+4}n/=6}return{h:360*n,s:o,l:s}},t.prototype.HSLToRGB=function(t,e,r){var a,i,n;if(0===e)a=i=n=r;else{t/=360;var o=r<.5?r*(1+e):r+e-r*e,s=2*r-o;a=this.HueToRGB(s,o,t+1/3),i=this.HueToRGB(s,o,t),n=this.HueToRGB(s,o,t-1/3)}return{r:Math.round(255*a),g:Math.round(255*i),b:Math.round(255*n)}},t.prototype.HueToRGB=function(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t},t}()),function(t){t[t.Integer=0]="Integer",t[t.Decimal=1]="Decimal"}(_||(_={}));var v,y=function(){function t(){}return t.Parse=function(t){if(this.pattern=t,this.characters=t.split("").map((function(t){return t.charCodeAt(0)})),this.char_index=0,this.current_section=new i,this.sections=[this.current_section],this.ParseDatePattern())return this.sections;for(this.char_index=0,this.current_section=new i,this.sections=[this.current_section];this.char_index<this.characters.length;)this.ConsumeChar();return this.sections},t.ConsumeString=function(){var t="";for(this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),++this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case 92:this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),this.char_index+1<this.characters.length&&(t+=this.pattern[++this.char_index]);break;case 34:return this.preserve_formatting_characters&&(t+=this.pattern[this.char_index]),this.char_index++,t;default:t+=this.pattern[this.char_index]}throw new Error("unterminated string")},t.ConsumeFormatting=function(){var t="";for(++this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case 92:throw new Error("invalid escape character in formatting block");case 93:return this.char_index++,t;default:t+=this.pattern[this.char_index]}throw new Error("unterminated format")},t.ScanFractionFormat=function(){var t=this.pattern.substr(this.char_index).match(/^([#?]+ +){0,1}([#?]+)\/([#?0-9]+)(?:$|[^#?0-9])/);if(!t)return!1;var e=(t[1]||"").length+t[2].length+t[3].length+1;this.current_section.fraction_format=!0,this.current_section.fraction_integer=!!t[1];var r=Number(t[3]);return isNaN(r)||(this.current_section.fraction_denominator=r),this.current_section.decimal_max_digits=this.current_section.fraction_denominator_digits=t[3].length,this.char_index+=e,this.current_section.has_number_format=!0,!0},t.ConsumeNumberFormat=function(){var t=_.Integer;for(this.char_index;this.char_index<this.characters.length;this.char_index++)switch(this.characters[this.char_index]){case this.group_separator:for(var e=!1,r=this.char_index+1;!e&&r<this.characters.length;r++){var a=this.characters[r];if(a===this.decimal_mark||35===a||48===a)e=!0;else if(44!==a)break}if(e){if(t===_.Decimal)throw new Error("invalid grouping in decimal part");this.current_section.grouping=!0}else this.current_section.scaling=1e3*(this.current_section.scaling||1);break;case this.decimal_mark:if(t===_.Decimal)throw new Error("too many decimal marks");t=_.Decimal;break;case 35:t===_.Decimal?this.current_section.decimal_max_digits++:this.current_section.integer_min_digits&&this.current_section.integer_min_digits++;break;case 48:t===_.Decimal?(this.current_section.decimal_max_digits++,this.current_section.decimal_min_digits=this.current_section.decimal_max_digits):this.current_section.integer_min_digits++;break;default:return}},t.AppendCharAsText=function(t){void 0===t&&(t=!0),this.current_section.has_number_format?this.current_section.suffix[this.current_section.suffix.length-1].text+=this.pattern[this.char_index]:this.current_section.prefix[this.current_section.prefix.length-1].text+=this.pattern[this.char_index],t&&this.char_index++},t.AppendString=function(t){this.current_section.has_number_format?this.current_section.suffix[this.current_section.suffix.length-1].text+=t:this.current_section.prefix[this.current_section.prefix.length-1].text+=t},t.AppendTextPart=function(t){this.current_section.has_number_format?(this.current_section.suffix.push(t),this.current_section.suffix.push({text:""})):(this.current_section.prefix.push(t),this.current_section.prefix.push({text:""}))},t.ConsumeChar=function(){var t=this.characters[this.char_index];if(63!==t&&35!==t||this.current_section.has_number_format||this.current_section.string_format||!this.ScanFractionFormat())switch(t){case 59:this.char_index++,this.current_section=new i,3===this.sections.length&&(this.current_section.string_format=!0),this.sections.push(this.current_section);break;case 64:this.char_index++,this.AppendTextPart({text:"@",flag:m.literal}),this.current_section.string_format=!0;break;case 48:case 35:case 46:case 44:this.current_section.has_number_format||this.current_section.string_format?this.AppendCharAsText():(this.ConsumeNumberFormat(),this.current_section.has_number_format=!0);break;case 91:this.AppendTextPart({text:this.ConsumeFormatting(),flag:m.formatting});break;case 34:this.AppendString(this.ConsumeString());break;case 63:this.preserve_formatting_characters?this.AppendCharAsText():(this.AppendTextPart({text:"0",flag:m.hidden}),this.char_index++);break;case 95:if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:m.hidden})}break;case 42:if(this.current_section.has_asterisk)throw new Error("we don't support multiple asterisks");if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:m.padded}),this.current_section.has_asterisk=!0}break;case 101:case 69:this.current_section.percent||this.current_section.exponential||this.current_section.string_format?this.AppendCharAsText():(this.current_section.exponential=!0,this.char_index++);break;case 37:this.current_section.exponential||this.current_section.string_format||(this.current_section.percent=!0),this.AppendCharAsText();break;case 92:if(this.preserve_formatting_characters&&this.AppendCharAsText(!1),++this.char_index>=this.characters.length)throw new Error("invalid escape character at end");this.AppendCharAsText();break;default:this.AppendCharAsText()}},t.ParseDatePattern=function(){var t=this;for(this.date_pattern=!0;this.date_pattern&&this.char_index<this.pattern.length;)this.DatePatternConsumeChar();if(this.date_pattern){this.date_pattern=!1;for(var e=0,r=this.sections;e<r.length;e++)for(var a=0,i=r[e].prefix;a<i.length;a++){var n=i[a];n.flag&&n.flag&(m.date_component|m.date_component_minutes)&&(this.date_pattern=!0)}}return this.date_pattern&&(this.sections[0].date_format=!0,this.sections[0].prefix.forEach((function(e,r){if(e.flag===m.date_component&&("mm"===e.text||"m"===e.text)){if(r)for(var a=r-1;a;a--)if((i=t.sections[0].prefix[a]).flag===m.date_component){/h/i.test(i.text)&&(e.flag=m.date_component_minutes,e.text=e.text.toLowerCase());break}if(r<t.sections[0].prefix.length-1)for(a=r+1;a<t.sections[0].prefix.length;a++){var i;if((i=t.sections[0].prefix[a]).flag===m.date_component){/s/i.test(i.text)&&(e.flag=m.date_component_minutes,e.text=e.text.toLowerCase());break}}}}))),this.date_pattern},t.ConsumeDatePart=function(){for(var t=this.pattern[this.char_index++],e=t.toLowerCase(),r={text:t,flag:m.date_component};this.pattern[this.char_index]&&this.pattern[this.char_index].toLowerCase()===e;)r.text+=this.pattern[this.char_index++];if("s"===e&&"."===this.pattern[this.char_index])for(r.text+=this.pattern[this.char_index++];"0"===this.pattern[this.char_index];)r.text+=this.pattern[this.char_index++];return r},t.ConsumeAMPM=function(){var t=this.pattern.substr(this.char_index,5);return"am/pm"===t||"AM/PM"===t?(this.char_index+=5,this.sections[0].twelve_hour=!0,{text:t,flag:m.date_component}):"a/p"===(t=this.pattern.substr(this.char_index,3))||"A/P"===t?(this.char_index+=3,this.sections[0].twelve_hour=!0,{text:t,flag:m.date_component}):void 0},t.DatePatternConsumeChar=function(){switch(this.characters[this.char_index]){case 59:this.char_index=this.characters.length;break;case 48:case 35:case 101:case 69:case 37:case 64:this.date_pattern=!1;break;case 72:case 104:case 77:case 109:case 83:case 115:case 68:case 100:case 89:case 121:this.AppendTextPart(this.ConsumeDatePart());break;case 65:case 97:var t=this.ConsumeAMPM();t?this.AppendTextPart(t):this.AppendCharAsText();break;case 34:this.AppendString(this.ConsumeString());break;case 63:this.preserve_formatting_characters?this.AppendCharAsText():(this.AppendTextPart({text:"0",flag:m.hidden}),this.char_index++);break;case 95:if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:m.hidden})}break;case 42:if(this.current_section.has_asterisk)throw new Error("we don't support multiple asterisks");if(this.preserve_formatting_characters)this.AppendCharAsText();else{if(++this.char_index>=this.characters.length)throw new Error("invalid pad character at end");this.AppendTextPart({text:this.pattern[this.char_index++],flag:m.padded}),this.current_section.has_asterisk=!0}break;case 92:if(this.preserve_formatting_characters&&this.AppendCharAsText(!1),++this.char_index>=this.characters.length)throw new Error("invalid escape character at end");this.AppendCharAsText();break;default:this.AppendCharAsText()}},t.date_pattern=!1,t.pattern="",t.char_index=0,t.characters=[],t.sections=[],t.current_section=new i,t.preserve_formatting_characters=!1,t.decimal_mark=46,t.group_separator=44,t}(),x=function(){return x=Object.assign||function(t){for(var e,r=1,a=arguments.length;r<a;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},x.apply(this,arguments)},b=function(t,e,r){if(r||2===arguments.length)for(var a,i=0,n=e.length;i<n;i++)!a&&i in e||(a||(a=Array.prototype.slice.call(e,0,i)),a[i]=e[i]);return t.concat(a||Array.prototype.slice.call(e))},w=function(t,e){if(void 0===e&&(e=!0),e){var r=new Date(t),a=new Date;a.setUTCMilliseconds(r.getUTCMilliseconds()),a.setUTCSeconds(r.getUTCSeconds()),a.setUTCMinutes(r.getUTCMinutes()),a.setUTCHours(r.getHours()),a.setUTCDate(r.getDate()),a.setUTCMonth(r.getMonth()),a.setUTCFullYear(r.getFullYear()),t=a.getTime()}return(t=(t+22090752e5)/864e5)>=60&&t++,t},C=function(){function t(t){if(this.magic_decimal=!1,this._pattern="",this.decimal_zero_regexp=[],this.cloned=[],this._pattern=t,this.sections=y.Parse(t),this.sections.length||(this.sections=[]),this.sections[0]||(this.sections[0]=new i),this.sections[1]||(this.sections[1]=x({},this.sections[0]),this.sections[1].prefix=JSON.parse(JSON.stringify(this.sections[1].prefix)),this.sections[1].suffix=JSON.parse(JSON.stringify(this.sections[1].suffix)),this.sections[1].prefix.push({text:"-"}),this.cloned[1]=!0),this.sections[2]||(this.sections[2]=x({},this.sections[0]),this.cloned[2]=!0),!this.sections[3])for(var e=0,r=this.sections[0].prefix;e<r.length;e++)if(r[e].flag===m.literal){this.sections[3]=x({},this.sections[0]),this.sections[3].string_format=!0,this.cloned[3]=!0;break}this.decimal_zero_regexp=this.sections.map((function(t){if(t.decimal_max_digits>t.decimal_min_digits)return new RegExp("0{1,"+(t.decimal_max_digits-t.decimal_min_digits)+"}(?:$|e)")}))}return Object.defineProperty(t.prototype,"pattern",{get:function(){return this._pattern},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"date_format",{get:function(){return this.sections[0]&&this.sections[0].date_format},enumerable:!1,configurable:!0}),t.FormatPartsAsText=function(t,e){void 0===e&&(e=0);var r=-1,a=t.map((function(t,e){switch(t.flag){case m.padded:return r=e,t.text;case m.hidden:return t.text.replace(/./g," ");case m.formatting:return"";default:return t.text}}));if(r>=0&&e){for(var i=a.reduce((function(t,e,a){return a===r?t:t+e.length}),0),n="",o=0;o<e-i;o++)n+=a[r];a[r]=n}return a.join("")},t.prototype.IncreaseDecimal=function(){this.sections.forEach((function(t){t.fraction_format?t.fraction_denominator||(t.fraction_denominator_digits=Math.min(t.fraction_denominator_digits+1,4)):(t.decimal_min_digits++,t.decimal_max_digits=t.decimal_min_digits)}))},t.prototype.DecreaseDecimal=function(){this.sections.forEach((function(t){t.fraction_format?t.fraction_denominator||(t.fraction_denominator_digits=Math.max(t.fraction_denominator_digits-1,1)):(t.decimal_min_digits=Math.max(0,t.decimal_min_digits-1),t.decimal_max_digits=t.decimal_min_digits)}))},t.prototype.AddGrouping=function(){this.sections.forEach((function(t){t.grouping=!0}))},t.prototype.RemoveGrouping=function(){this.sections.forEach((function(t){t.grouping=!1}))},t.prototype.ToggleGrouping=function(){var t=!this.sections[0].grouping;this.sections.forEach((function(e){e.grouping=t}))},t.prototype.toString=function(){var t=this;return this.sections[0].date_format?this._pattern:this.sections.filter((function(e,r){return!t.cloned[r]})).map((function(t){var e="",r=0;if(t.fraction_format){t.fraction_integer&&(e+="? ");for(var a="",i=0;i<t.fraction_denominator_digits;i++)a+="#";e+=a,e+="/",t.fraction_denominator?e+=t.fraction_denominator:e+=a}else if(t.has_number_format){for(r=0;r<t.integer_min_digits;r++)e+="0";if(t.grouping&&(e.length<4&&(e=("####"+e).slice(-4)),e=e.replace(/[\d#]{1,3}(?=([\d#]{3})+(?![\d#]))/g,"$&,")),t.decimal_max_digits||t.decimal_min_digits){for(e+=".",r=0;r<t.decimal_min_digits;r++)e+="0";for(;r<t.decimal_max_digits;r++)e+="#"}if(t.scaling){var n=Math.log10(t.scaling)/3;for(r=0;r<n;r++)e+=","}t.exponential&&(e+="e")}return t.prefix.map((function(t){return t.flag===m.hidden?"0"===t.text?"?":"_"+t.text:t.flag===m.padded?"*"+t.text:t.flag===m.formatting?"["+t.text+"]":t.text})).join("")+e+t.suffix.map((function(t){return t.flag===m.hidden?"0"===t.text?"?":"_"+t.text:t.flag===m.padded?"*"+t.text:t.text})).join("")})).join(";")},t.prototype.FormatComplex=function(e){var r=!!e.imaginary;r&&(r=this.FormatParts(e.imaginary).some((function(t){return/[1-9]/.test(t.text)})));var a=!!e.real;a&&(a=this.FormatParts(e.real).some((function(t){return/[1-9]/.test(t.text)})));var i=[];return a||!a&&!r?(i.push.apply(i,this.FormatParts(e.real)),r&&(Math.abs(e.imaginary),i.push({text:e.imaginary<0?" "+t.minus_character+" ":" + "}),i.push.apply(i,b(b([],this.FormatParts(Math.abs(e.imaginary)),!1),[{text:t.imaginary_character}],!1)))):r&&i.push.apply(i,b(b([],this.FormatParts(e.imaginary),!1),[{text:t.imaginary_character}],!1)),i},t.prototype.FormatParts=function(t){if("number"!=typeof t&&!this.sections[3])return[{text:t.toString()}];var e=this.BaseFormat(t),r=e.parts,a=e.section,i=[];if(a.date_format||a.string_format)for(var n=0,o=r;n<o.length;n++){var s=o[n];"string"==typeof s?i.push({text:s}):i.push(s)}else this.magic_decimal&&""===r[1]&&r.splice(1,1),i=b(b(b([],a.prefix.map((function(t){return x({},t)})),!0),[{text:a.has_number_format?r.join(d.decimal_separator):""}],!1),a.suffix.map((function(t){return x({},t)})),!0);for(var h=1;h<i.length;h++)i[h].flag===i[h-1].flag&&(i[h].text=i[h-1].text+i[h].text,i[h-1].text="");return i.filter((function(t){return t.text}))},t.prototype.Format=function(e,r){return void 0===r&&(r=0),t.FormatPartsAsText(this.FormatParts(e),r)},t.prototype.ZeroPad=function(t,e){for(;t.length<e;)t="0"+t;return t},t.prototype.DateFormat=function(t){var e=this,r=function(t){return t>=60&&t--,new Date(864e5*t-22090752e5)}(t),a=this.sections[0],i=r.getUTCHours();return a.twelve_hour&&(i>12&&(i-=12),0===i&&(i=12)),{parts:a.prefix.map((function(t){if(t.flag===m.date_component_minutes)return"mm"===t.text?{text:e.ZeroPad(r.getUTCMinutes().toString(),2)}:{text:e.ZeroPad(r.getUTCMinutes().toString(),1)};if(t.flag===m.date_component){switch(t.text.toLowerCase()){case"am/pm":case"a/p":var a=t.text.split("/");return{text:r.getUTCHours()>12?a[1]:a[0]};case"mmmmm":return{text:d.date_components.long_months[r.getUTCMonth()][0]};case"mmmm":return"MMMM"===t.text?{text:d.date_components.long_months[r.getUTCMonth()].toUpperCase()}:{text:d.date_components.long_months[r.getUTCMonth()]};case"mmm":return"MMM"===t.text?{text:d.date_components.short_months[r.getUTCMonth()].toUpperCase()}:{text:d.date_components.short_months[r.getUTCMonth()]};case"mm":return{text:e.ZeroPad((r.getUTCMonth()+1).toString(),2)};case"m":return{text:e.ZeroPad((r.getUTCMonth()+1).toString(),1)};case"ddddd":case"dddd":return"DDDDD"===t.text||"DDDD"===t.text?{text:d.date_components.long_days[r.getUTCDay()].toUpperCase()}:{text:d.date_components.long_days[r.getUTCDay()]};case"ddd":return"DDD"===t.text?{text:d.date_components.short_days[r.getUTCDay()].toUpperCase()}:{text:d.date_components.short_days[r.getUTCDay()]};case"dd":return{text:e.ZeroPad(r.getUTCDate().toString(),2)};case"d":return{text:e.ZeroPad(r.getUTCDate().toString(),1)};case"yyyy":case"yyy":return{text:r.getUTCFullYear().toString()};case"yy":case"y":return{text:e.ZeroPad((r.getUTCFullYear()%100).toString(),2)};case"hh":return{text:e.ZeroPad(i.toString(),2)};case"h":return{text:e.ZeroPad(i.toString(),1)};case"ss":return{text:e.ZeroPad(r.getUTCSeconds().toString(),2)};case"s":return{text:e.ZeroPad(r.getUTCSeconds().toString(),1)}}var n=t.text.match(/^(s+)\.(0+)$/);if(n)return{text:e.ZeroPad(r.getUTCSeconds().toString(),n[1].length)+d.decimal_separator+(r.getUTCMilliseconds()/1e3).toFixed(n[2].length).substr(2)}}return x({},t)})),section:a}},t.prototype.StringFormat=function(t,e){for(var r=[],a=0,i=e.prefix;a<i.length;a++){var n=i[a];n.flag===m.literal?r.push({text:t}):r.push(x({},n))}return{parts:r,section:e}},t.prototype.Round2=function(t,e){var r=Math.pow(10,e);return Math.round(r*t)/r},t.prototype.FormatFraction=function(e,r){r.percent&&(e*=100);var a={denominator:1,numerator:Math.round(e),error:Math.abs(Math.round(e)-e)};if(r.fraction_denominator)a.denominator=r.fraction_denominator,a.numerator=Math.round(e*a.denominator);else if(a.error)for(var i=t.fraction_limits[r.fraction_denominator_digits-1]||t.fraction_limits[0],n=2;n<=i;n++){var o=Math.round(e*n),s=Math.abs(o/n-e);if(s<a.error&&(a={numerator:o,denominator:n,error:s},!s))break}var h=[];if(r.fraction_integer){var l=Math.floor(a.numerator/a.denominator);a.numerator%=a.denominator,!l&&a.numerator||(h.push(l.toString()),a.numerator&&h.push(" "))}else a.numerator||h.push("0");return a.numerator&&(h.push(a.numerator.toString()),h.push("/"),h.push(a.denominator.toString())),h.join("")},t.prototype.BaseFormat=function(e){if(this.sections[0].date_format)return this.DateFormat(Number(e));if("number"!=typeof e)return this.StringFormat(e.toString(),this.sections[3]);var r=this.sections[0],a=this.decimal_zero_regexp[0];e<0&&(r=this.sections[1]);var i=r.percent?r.decimal_max_digits+2:r.decimal_max_digits,n=Math.pow(10,-i)/2,o=Math.abs(e);if(o<n&&(r=this.sections[2],a=this.decimal_zero_regexp[2]),r.scaling&&(o/=r.scaling)<n&&(r=this.sections[2],a=this.decimal_zero_regexp[2]),r.string_format)return this.StringFormat(e.toString(),r);var s="";if(r.fraction_format)return{parts:[this.FormatFraction(o,r)],section:r};r.exponential?s=o.toExponential(r.decimal_max_digits):(r.percent&&(o*=100),s=this.Round2(o,r.decimal_max_digits).toFixed(r.decimal_max_digits)),a&&(s=s.replace(a,""));for(var h=s.split(".");h[0].length<r.integer_min_digits;)h[0]=("0000000000000000"+h[0]).slice(-r.integer_min_digits);return 0===r.integer_min_digits&&"0"===h[0]&&(h[0]=""),r.grouping&&(h[0]=h[0].replace(t.grouping_regexp,"$&"+d.grouping_separator)),{parts:h,section:r}},t.grouping_regexp=/\d{1,3}(?=(\d{3})+(?!\d))/g,t.fraction_limits=[9,99,999,9999],t.imaginary_character="𝑖",t.minus_character="-",t}(),M=function(){function t(){}return t.Get=function(t,e){if(void 0===e&&(e=!1),e&&"General"===t)return this.complex_general;var r=this.symbolc_name_map[t.toLowerCase()],a=this.cache[r||t];return a||(a=new C(t),this.cache[t]=a),a},t.Equals=function(t,e){if(t===e)return!0;var r=this.Get(t),a=this.Get(e);return r.pattern===a.pattern},t.Translate=function(t){var e=this.symbolc_name_map[t.toLowerCase()];return e?this.cache[e].toString():t},t.SymbolicName=function(t){for(var e=0,r=Object.keys(this.base_formats);e<r.length;e++){var a=r[e];if(t===this.base_formats[a])return a}return null},t.InitCache=function(){for(var t=0,e=Object.keys(this.base_formats);t<e.length;t++){var r=e[t];this.cache[r]=new C(this.base_formats[r]),this.symbolc_name_map[r.toLowerCase()]=r}this.cache.General.magic_decimal=!0,this.complex_general=new C("0.###"),this.complex_general.magic_decimal=!0;for(var a=0,i=Object.keys(this.aliases);a<i.length;a++)r=i[a],this.cache[r]=this.cache[this.aliases[r]],this.symbolc_name_map[r.toLowerCase()]=r},t.cache={},t.symbolc_name_map={},t.base_formats={Accounting:"_(#,##0.00_);(#,##0.00);-???",Number:"0.00",Integer:"0",Percent:"0.00%",General:"0.######",Fraction:"# ?/?",Dollar:"$* _(#,##0.00_);$* (#,##0.00);$* -???",Exponential:"0.000e","Short Date":"mm/dd/yy","Long Date":"dddd, mmm d yyyy",Timestamp:"mm-dd-yy hh:mm:ss"},t.aliases={Scientific:"Exponential",Percentage:"Percent",Currency:"Dollar"},t}();M.InitCache(),function(t){t[t.None=0]="None",t[t.Nan=1]="Nan",t[t.Exponential=2]="Exponential",t[t.Percent=4]="Percent",t[t.Currency=8]="Currency",t[t.Grouping=16]="Grouping",t[t.Parens=32]="Parens",t[t.Date=64]="Date",t[t.Time=128]="Time"}(v||(v={}));var S,A,k,P=(new Date).getUTCFullYear(),T=new(function(){function e(){}return e.prototype.TestDate=function(t){var e=Date.parse(t);if(isNaN(e))return!1;var r=new Date(e),a=t.replace(/[\d\-\\/,.\s]+/g," ").toLocaleLowerCase().split(/\s+/).map((function(t){return t.trim()})).filter((function(t){return!!t}));if(!a.length)return e;if(!this.compare_month){this.compare_month={};for(var i=0;i<12;i++)this.compare_month[d.date_components.long_months[i].toLocaleLowerCase().replace(/\./,"")]=i,this.compare_month[d.date_components.short_months[i].toLocaleLowerCase().replace(/\./,"")]=i}if(!this.compare_day)for(this.compare_day={},i=0;i<7;i++)this.compare_day[d.date_components.long_days[i].toLocaleLowerCase().replace(/\./,"")]=i,this.compare_day[d.date_components.short_days[i].toLocaleLowerCase().replace(/\./,"")]=i;for(var n=!1,o=!1,s=0,h=a;s<h.length;s++){for(var l=h[s],c=!1,u=0,p=Object.entries(this.compare_month);u<p.length;u++){var m=p[u],f=m[0],_=m[1];if(l===f){if(n)return!1;if(r.getUTCMonth()!==_)return!1;c=!0,n=!0}}if(!c)for(var g=0,v=Object.entries(this.compare_day);g<v.length;g++){var y=v[g],x=y[0];if(_=y[1],l===x){if(o)return!1;if(r.getUTCDay()!==_)return!1;c=!0,o=!0}}if(!c)return!1}return!(o&&!n)&&e},e.prototype.TryParse=function(e){void 0===e&&(e="");var r=v.None;if("'"===e[0])return{value:e,type:t.string};if(""===e)return{value:e,type:t.string};if("NaN"===e)return{value:NaN,type:t.number,hints:v.Nan};var a=e.trim(),i=a.match(/^[$](.*?)$/);i&&(a=i[1],r|=v.Currency);var n=a.match(/^\((.*?)\)$/);n&&(a=n[1],r|=v.Parens);var o=a.match(/^(.*?)%\s*$/);o&&(a=o[1],r|=v.Percent),"."===d.decimal_separator?/,/.test(a)&&(a=a.replace(/,/g,""),r|=v.Grouping):a=(a=(a=a.replace(/(\d)\s+/g,"$1")).replace(/\./g,"")).replace(/,/,".");var s=Number(a);if(null===s||isNaN(s)){var h=e.toLowerCase();if("false"===h)return{value:!1,type:t.boolean};if("true"===h)return{value:!0,type:t.boolean};var l=this.TestDate(e);if(!1!==l&&!isNaN(l)){var c=new Date(l),u=c.getUTCFullYear();if(u>=P-200&&u<=P+200)return r=v.Date,(c.getHours()||c.getMinutes()||c.getSeconds())&&(r|=v.Time),{value:w(l),type:t.number,hints:r}}return{value:e,type:t.string}}if(n&&(s=-s),o){var p=s<0?-1:1,m=(p*s).toString().split(".");m[0]=("00"+m[0]).replace(/(\d\d)$/,".$1"),s=Number(m.join(""))*p}return/e/.test(e)&&(r|=v.Exponential),{value:s,type:t.number,hints:r}},e}()),R=function(){function t(t,e,r,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=100),void 0===a&&(a=100),this.left=t,this.top=e,this.right=r,this.bottom=a}return Object.defineProperty(t.prototype,"width",{get:function(){return this.right-this.left},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.bottom-this.top},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},enumerable:!1,configurable:!0}),t}();!function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"}(S||(S={})),function(t){t[t.top=0]="top",t[t.bottom=1]="bottom",t[t.left=2]="left",t[t.right=3]="right"}(A||(A={})),function(t){t[t.line=0]="line",t[t.marker=1]="marker"}(k||(k={}));var L="http://www.w3.org/2000/svg",D=function(t,e,r){void 0===e&&(e={});for(var a=document.createElementNS(L,t),i=0,n=Object.keys(e);i<n.length;i++){var o=n[i];if(void 0!==e[o]){var s=e[o];a.setAttribute(o,Array.isArray(s)?s.join(" "):s.toString())}}return r&&(a.textContent=r),a},F=function(){function t(){this.size={width:0,height:0},this.bounds=new R,this.container_group=D("g"),this.group=D("g"),this.axis_group=D("g",{class:"axis-group"}),this.label_group=D("g",{class:"label-group"}),this.container_group.appendChild(this.axis_group),this.container_group.appendChild(this.group),this.container_group.appendChild(this.label_group)}return t.prototype.Initialize=function(t){this.parent=t,this.svg_node=D("svg",{class:"treb-chart"}),this.svg_node.style.overflow="hidden",this.svg_node.style.position="relative",this.svg_node.style.width="100%",this.svg_node.style.height="100%",this.svg_node.appendChild(this.container_group),this.parent.appendChild(this.svg_node),this.Resize()},t.prototype.Legend=function(t){var e=D("g");this.group.appendChild(e);var r=D("text");e.appendChild(r),e.setAttribute("class","legend");var a=[[]],i=t.area.width,n=0,o=0,s=t.area.width,h=t.style===k.marker?14:26,l=t.labels.map((function(e,l){r.textContent=e;var c=r.getBoundingClientRect(),u={width:c.width,height:c.height},d=u.width+h+10;return o=Math.max(o,u.height),t.layout===S.vertical?a[l]=[l]:d>i?0===a[n].length?(a[n].push(l),n++,a[n]=[],i=s):(n++,a[n]=[l],i=s-d):(a[n].push(l),i-=d),u}));e.removeChild(r);var c=o,u=t.layout||S.horizontal;u===S.horizontal&&a.every((function(t){return t.length<=1}))&&(u=S.horizontal);for(var d=0;d<a.length;d++){for(var p=a[d].reduce((function(t,e){return t+l[e].width+h}),10*(a[d].length-1)),m=0,f=u===S.horizontal?Math.round((s-p)/2):Math.round(5),_=0;_<a[d].length;_++){var g=a[d][_],v=l[g],y=t.labels[g],x=c-1,b=!1;"undefined"!=typeof navigator&&(b=/trident/i.test((null===navigator||void 0===navigator?void 0:navigator.userAgent)||"")),e.appendChild(D("text",{"dominant-baseline":"middle",x:f+h,y:c,dy:b?".3em":void 0},y)),t.style===k.marker?e.appendChild(D("rect",{class:"series-"+(g+1),x:f,y:x-4,width:8,height:8})):e.appendChild(D("rect",{class:"series-"+(g+1),x:f,y:x-1,width:h-3,height:2})),m=Math.max(m,v.height),f+=v.width+h+10}c=Math.round(c+1.1*m)}var w=e.getBoundingClientRect(),C=w.width,M=w.height+o;switch(t.position){case A.bottom:e.setAttribute("transform","translate("+t.area.left+", "+(t.area.bottom-M)+")");break;case A.left:e.setAttribute("transform","translate("+t.area.left+", "+t.area.top+")");break;case A.right:e.setAttribute("transform","translate("+(t.area.right-C)+", "+t.area.top+")");break;case A.top:default:e.setAttribute("transform","translate("+t.area.left+", "+t.area.top+")")}t.position===A.top?t.area.top+=M||0:t.position===A.right?t.area.right-=(C||0)+8:t.position===A.left?t.area.left+=(C||0)+8:t.area.bottom-=M||0},t.prototype.Clear=function(){this.group.textContent="",this.axis_group.textContent="",this.label_group.textContent=""},t.prototype.Resize=function(){var t=this.parent.getBoundingClientRect();this.svg_node.setAttribute("width",t.width.toString()),this.svg_node.setAttribute("height",t.height.toString()),this.size={width:t.width,height:t.height}},t.prototype.Prerender=function(){var t=this.svg_node.getBoundingClientRect();this.bounds.top=t.top,this.bounds.left=t.left,this.bounds.right=t.right,this.bounds.bottom=t.bottom},t.prototype.RenderTitle=function(t,e,r,a){var i=D("text",{class:"chart-title",x:Math.round(e.width/2)},t);i.style.textAnchor="middle",this.group.appendChild(i);var n=i.getBoundingClientRect();"bottom"===a?(i.setAttribute("y",Math.round(e.bottom-n.height).toString()),e.bottom-=n.height+r):(i.setAttribute("y",Math.round(e.top+r+n.height).toString()),e.top+=n.height+r)},t.prototype.MeasureText=function(t,e,r){void 0===r&&(r=!1),this.text_measurement_node||(this.text_measurement_node=D("text",{x:"-100px",y:"-100px"}),this.svg_node.appendChild(this.text_measurement_node)),void 0!==e?("string"==typeof e&&(e=[e]),this.text_measurement_node.setAttribute("class",e.join(" "))):this.text_measurement_node.setAttribute("class",""),this.text_measurement_node.textContent=t;var a=this.text_measurement_node.getBoundingClientRect(),i={width:a.width,height:a.height,y_offset:a.height-(this.bounds.top-a.top-100)};return r&&(i.width=Math.ceil(i.width),i.height=Math.ceil(i.height),i.y_offset=Math.ceil(i.y_offset)),i},t.prototype.RenderTicks=function(t,e,r,a,i){for(var n=[],o=t.width/a,s=0;s<a;s++){var h=Math.round(t.left+o/2+o*s)-.5;n.push("M"+h+" "+e+" L"+h+" "+r)}this.group.appendChild(D("path",{d:n,class:i}))},t.prototype.RenderXAxisBar=function(t,e,r,a,i){var n=r.length;if(n){for(var o=e?t.width/n:t.width/(n-1),s=e?o/2:0,h=1,l=!0;l;){l=!1;for(var c=0,u=0;u<n;u+=h){var d=Math.round(t.left+s+o*u),p=d-a[u].width/2;if(c&&p<=c){h++,l=!0;break}c=d+a[u].width/2+4}}for(u=0;u<n;u+=h){var m=Math.round(t.left+s+o*u);this.RenderText(this.axis_group,r[u],"center",{x:m,y:t.bottom},i)}}},t.prototype.RenderXAxisTicks=function(t,e,r){for(var a=e?t.width/r:t.width/(r-1),i=e?a/2:0,n=[],o=0;o<r;o++){var s=Math.round(t.left+i+a*o)+.5;n.push("M"+s+","+(t.bottom+.5)+" v6")}this.axis_group.appendChild(D("path",{d:n.join(" "),class:"x-axis-tick axis-tick"}))},t.prototype.RenderXAxis=function(t,e,r,a,i){var n=r.length;if(n){for(var o=e?t.width/n:t.width/(n-1),s=e?o/2:0,h=1,l=!0,c=(r.length-1)%2==0,u=(r.length-1)%3==0;l;){l=!1;for(var d=0,p=0;p<n;p+=h){var m=Math.round(t.left+s+o*p),f=m-a[p].width/2;if(d&&f<=d){h++,l=!0;break}d=m+a[p].width/2+4}}for(3===h&&!u&&c&&h++,p=0;p<n;p+=h){var _=Math.round(t.left+s+o*p);this.RenderText(this.axis_group,r[p],"center",{x:_,y:t.bottom},i)}}},t.prototype.RenderYAxisBar=function(t,e,r,a){(r=r.slice(0)).reverse();var i=r.length;if(i){for(var n=t.height/i,o=1,s=!0;s;){s=!1;for(var h=0,l=0;l<i;l+=o){var c=r[l],u=Math.round(t.bottom-n*(l+.5)+c.metrics.height/4);if(h&&u>=h){o++,s=!0;break}h=u-c.metrics.height}}for(l=0;l<i;l+=o)c=r[l],u=Math.round(t.bottom-n*(l+.5)+c.metrics.height/4),this.RenderText(this.axis_group,c.label,"right",{x:e,y:u},a)}},t.prototype.RenderYAxis=function(t,e,r,a){var i=r.length;if(i){for(var n=t.height/(i-1),o=1,s=!0;s;){s=!1;for(var h=0,l=0;l<i;l+=o){var c=r[l],u=Math.round(t.bottom-n*l+c.metrics.height/4);if(h&&u>=h){o++,s=!0;break}h=u-c.metrics.height}}for(l=0;l<i;l+=o)c=r[l],u=Math.round(t.bottom-n*l+c.metrics.height/4),this.RenderText(this.axis_group,c.label,"right",{x:e,y:u},a)}},t.prototype.LineProperties=function(t,e){var r=e.x-t.x,a=e.y-t.y;return{length:Math.sqrt(r*r+a*a),angle:Math.atan2(a,r)}},t.prototype.RenderSmoothLine=function(t,e,r,a,i){var n=this;void 0===r&&(r=!1);for(var o=D("g"),s=[],h=[],l=e.length,c=l-1,u=t.width/l/2,d=[],p=e.map((function(e,r){if(void 0!==e)return{x:Math.round(t.left+t.width/c*r),y:t.bottom-e}})),m=[],f=function(){if(!(m.length<2)){var e="",a=m[0],i=m[m.length-1];2===m.length?e=m[0].x+","+m[0].y+" L"+m[1].x+","+m[1].y:m.length>2&&(e=""+n.CatmullRomChain(m).map((function(t){return t.x+","+t.y})).join(" L")),e&&(s.push("M"+e),r&&(h.push("M "+a.x+","+t.bottom+" L "+a.x+","+a.y),h.push("L"+e),h.push("L "+i.x+","+t.bottom)))}},_=0,g=p;_<g.length;_++){var v=g[_];v?m.push(v):(f(),m=[])}if(m.length&&f(),r&&o.appendChild(D("path",{class:"fill",d:h})),o.appendChild(D("path",{class:"line",d:s})),void 0!==i&&("string"==typeof i&&(i=[i]),o.setAttribute("class",i.join(" "))),this.group.appendChild(o),a&&d.length){for(var y=document.createElementNS(L,"g"),x=function(t){var e=D("circle",{cx:t.x,cy:t.y,r:u});e.addEventListener("mouseenter",(function(e){n.parent.setAttribute("title",a[t.i]||"")})),e.addEventListener("mouseleave",(function(t){n.parent.setAttribute("title","")})),y.appendChild(e)},b=0,w=d;b<w.length;b++)x(w[b]);y.setAttribute("class","mouse-layer"),this.group.appendChild(y)}},t.prototype.RenderLine=function(t,e,r,a,i){var n=this;void 0===r&&(r=!1);for(var o,s=document.createElementNS(L,"g"),h=[],l=[],c=e.length,u=c-1,d=t.width/c/2,p=[],m=0,f=!0;m<c;m++){var _=e[m];if(void 0!==_){var g=Math.round(+t.left+t.width/u*m);f?(r&&l.push("M"+g+" "+t.bottom+" L"+g+" "+(t.bottom-_)),h.push("M"+g+" "+(t.bottom-_))):(h.push("L"+g+" "+(t.bottom-_)),l.push("L"+g+" "+(t.bottom-_))),p.push({x:g,y:t.bottom-_,i:m}),o=g,f=!1}else f=!0,r&&void 0!==o&&l.push("L"+o+" "+t.bottom+"Z"),o=void 0}if(r&&void 0!==o&&l.push("L"+o+" "+t.bottom+"Z"),r&&s.appendChild(D("path",{class:"fill",d:l})),s.appendChild(D("path",{class:"line",d:h})),void 0!==i&&("string"==typeof i&&(i=[i]),s.setAttribute("class",i.join(" "))),this.group.appendChild(s),a&&p.length){for(var v=document.createElementNS(L,"g"),y=function(t){var e=D("circle",{cx:t.x,cy:t.y,r:d});e.addEventListener("mouseenter",(function(e){n.parent.setAttribute("title",a[t.i]||"")})),e.addEventListener("mouseleave",(function(t){n.parent.setAttribute("title","")})),v.appendChild(e)},x=0,b=p;x<b.length;x++)y(b[x]);v.setAttribute("class","mouse-layer"),this.group.appendChild(v)}},t.prototype.RenderBarGrid=function(t,e,r){for(var a=[],i=t.width/e,n=0;n<=e;n++){var o=Math.round(t.left+i*n)-.5;a.push("M"+o+" "+t.top+" L"+o+" "+t.bottom)}this.group.appendChild(D("path",{d:a,class:r}))},t.prototype.RenderGrid=function(t,e,r,a){void 0===r&&(r=0);for(var i=[],n=t.height/e,o=0;o<=e;o++){var s=Math.round(t.top+n*o)-.5;i.push("M"+t.left+" "+s+" L"+t.right+" "+s)}for(n=t.width/(r-1),o=0;o<r;o++){var h=Math.round(t.left+n*o)-.5;i.push("M"+h+" "+t.top+" L"+h+" "+t.bottom)}this.group.appendChild(D("path",{d:i,class:a}))},t.prototype.MultiplyPoint=function(t,e){return{x:t.x*e,y:t.y*e}},t.prototype.AddPoints=function(t,e){return{x:t.x+e.x,y:t.y+e.y}},t.prototype.CatmullRomSpline=function(t,e){for(var r=function(t,e,r){var a=e.x,i=e.y,n=r.x,o=r.y;return Math.pow(Math.pow(n-a,2)+Math.pow(o-i,2),.25)+t},a=r(0,t[0],t[1]),i=r(a,t[1],t[2]),n=r(i,t[2],t[3]),o=(i-a)/e,s=[],h=0;h<e;h++){var l=a+o*h,c=this.AddPoints(this.MultiplyPoint(t[0],(a-l)/(a-0)),this.MultiplyPoint(t[1],(l-0)/(a-0))),u=this.AddPoints(this.MultiplyPoint(t[1],(i-l)/(i-a)),this.MultiplyPoint(t[2],(l-a)/(i-a))),d=this.AddPoints(this.MultiplyPoint(t[2],(n-l)/(n-i)),this.MultiplyPoint(t[3],(l-i)/(n-i))),p=this.AddPoints(this.MultiplyPoint(c,(i-l)/(i-0)),this.MultiplyPoint(u,(l-0)/(i-0))),m=this.AddPoints(this.MultiplyPoint(u,(n-l)/(n-a)),this.MultiplyPoint(d,(l-a)/(n-a))),f=this.AddPoints(this.MultiplyPoint(p,(i-l)/(i-a)),this.MultiplyPoint(m,(l-a)/(i-a)));s.push(f)}return s},t.prototype.CatmullRomChain=function(t,e){void 0===e&&(e=30);var r=t.slice(0),a=[],i=r.length;if(i){var n=r[i-1].x-r[i-2].x,o=r[i-1].y-r[i-2].y;r.push({x:r[i-1].x+n,y:r[i-1].y+o}),r.push({x:r[i-1].x+n,y:r[i-1].y+o}),n=r[1].x-r[0].x,o=r[1].y-r[0].y,r.unshift({x:r[0].x-n,y:r[0].y-o});for(var s=0;s<r.length-4;s++){var h=r.slice(s,s+4),l=this.CatmullRomSpline(h,e);a.push.apply(a,l)}}return a},t.prototype.RenderDataLabels=function(t,e,r,a,i,n,o){for(var s=Math.max(e.length,r.length),h=a.max-a.min||1,l=i.max-i.min||1,c=0;c<s;c++){var u=e[c],d=r[c];if(void 0!==u&&void 0!==d){var p={x:t.left+(u-a.min)/h*t.width,y:t.bottom-(d-i.min)/l*t.height},m=n[c];if(m){this.label_group.appendChild(D("circle",{class:"label-target",cx:p.x,cy:p.y,r:10}));var f=D("g",{class:"data-label",transform:"translate("+(p.x+10)+","+p.y+")"});this.label_group.appendChild(f);var _=D("circle",{cx:-10,y:0,r:5,class:"marker-highlight series-"+o});f.appendChild(_);var g=D("text",{x:4,y:0},m);f.appendChild(g);var v=g.getBoundingClientRect(),y=v.height,x=v.width+8;x+15+p.x>=t.right&&(f.setAttribute("transform","translate("+(p.x-x-15)+","+p.y+")"),_.setAttribute("cx",(x+15).toString()));var b=D("path",{d:"M0,5 h"+x+" v-"+y+" h-"+x+" Z"});f.insertBefore(b,g)}}}},t.prototype.RenderScatterSeries=function(t,e,r,a,i,n,o,s,h,l,c){var u=this;void 0===n&&(n=!0),void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===h&&(h=!1),void 0===l&&(l=!1);var d=Math.max(e.length,r.length),p=a.max-a.min||1,m=i.max-i.min||1,f=[],_=[],g=[],v=D("g",{class:c});this.group.appendChild(v);for(var y=0;y<d;y++){var x=e[y],b=r[y];void 0===x||void 0===b?f.push(void 0):f.push({x:t.left+(x-a.min)/p*t.width,y:t.bottom-(b-i.min)/m*t.height})}if(n){for(var w=[],C=l?function(){return 2===w.length?w[0].x+","+w[0].y+" L"+w[1].x+","+w[1].y:w.length>2?u.CatmullRomChain(w).map((function(t){return t.x+","+t.y})).join(" L"):""}:function(){return w.map((function(t){return t.x+","+t.y})).join(" L")},M=0,S=f;M<S.length;M++)if(L=S[M])w.push(L);else{if(w.length>=2){var A=C();_.push("M"+A),g.push("M"+w[0].x+","+t.bottom+"L"+A+"L"+w[w.length-1].x+","+t.bottom+"Z")}w=[]}w.length>=2&&(A=C(),_.push("M"+A),g.push("M"+w[0].x+","+t.bottom+"L"+A+"L"+w[w.length-1].x+","+t.bottom+"Z"))}if(s&&v.appendChild(D("path",{d:g,class:"fill"})),n&&v.appendChild(D("path",{d:_,class:"line"})),o)for(var k=0,P=f;k<P.length;k++)(L=P[k])&&v.appendChild(D("circle",{cx:L.x,cy:L.y,r:1,class:"point"}));if(h)for(var T=0,R=f;T<R.length;T++){var L;(L=R[T])&&v.appendChild(D("circle",{cx:L.x,cy:L.y,r:3,class:"marker"}))}},t.prototype.RenderPoints=function(t,e,r,a){for(var i=[],n=0;n<e.length;n++){var o=e[n]*t.width+t.left,s=t.bottom-r[n]*t.height;i.push("M"+(o-1)+","+(s-1)+" L"+(o+1)+","+(s+1)),i.push("M"+(o-1)+","+(s+1)+" L"+(o+1)+","+(s-1))}this.group.appendChild(D("path",{d:i,class:a}))},t.prototype.RenderPoint=function(t,e,r){this.group.appendChild(D("circle",{cx:t,cy:e,r:1,class:r}))},t.prototype.RenderCalloutLines=function(t){var e=D("g",{class:"callouts"});this.label_group.appendChild(e);for(var r=0,a=t;r<a.length;r++){var i=a[r];e.appendChild(D("path",{d:"M"+i.x1+","+i.y1+" L"+i.x2+","+i.y2,class:"callout "+(i.classes||"").trim()}))}},t.prototype.RenderRectangle=function(t,e,r,a,i,n){var o=this,s="";if(e)if(e[0]&&e[0]===e[1]&&e[0]>=t.height){var h=e[0],l=e[0]-t.height,c=Math.sqrt(h*h-l*l);s="M"+(t.left+t.width/2-c)+","+t.bottom+" a"+h+","+h+" 0 0 1 "+2*c+",0 z"}else e[1]&&e[1]===e[2]&&e[1]>=t.width?(h=e[1],l=e[1]-t.width,c=Math.sqrt(h*h-l*l),s="M"+t.left+","+(t.top+t.height/2-c)+" a"+h+","+h+" 0 0 1 0,"+2*c+" z"):s="M"+t.left+","+(t.top+e[0])+" a"+e[0]+","+e[0]+" 0 0 1 "+e[0]+","+-e[0]+" h"+(t.width-e[0]-e[1])+" a"+e[1]+","+e[1]+" 0 0 1 "+e[1]+","+e[1]+" v"+(t.height-e[1]-e[2])+" a"+e[2]+","+e[2]+" 0 0 1 "+-e[2]+","+e[2]+" h"+(-t.width+e[2]+e[3])+" a"+e[3]+","+e[3]+" 0 0 1 "+-e[3]+","+-e[3]+" v"+(-t.height+e[3]+e[0])+" ";else s="M"+t.left+","+t.top+" h"+t.width+" v"+t.height+" h"+-t.width+" v"+-t.height+" ";var u=D("path",{d:s,class:r});if(a&&(u.addEventListener("mouseenter",(function(t){o.parent.setAttribute("title",a)})),u.addEventListener("mouseleave",(function(t){o.parent.setAttribute("title","")}))),this.group.appendChild(u),i){this.label_group.appendChild(D("path",{class:"label-target",d:s}));var d=n||{x:Math.round(t.left+t.width/2),y:Math.round(t.top-10)},p=D("g",{class:"data-label",transform:"translate("+d.x+","+d.y+")"});this.label_group.appendChild(p);var m=D("text",{x:0,y:0},i);p.appendChild(m);var f=m.getBoundingClientRect(),_=f.height,g=f.width+8;d.y-f.height<4&&(d.y-=d.y-f.height-4,p.setAttribute("transform","translate("+d.x+","+d.y+")")),m.setAttribute("x",Math.floor(-f.width/2).toString());var v=Math.ceil(.125*_),y=D("rect",{rx:3,x:-g/2,y:Math.round(2*v/3-_),width:g,height:_+v});p.insertBefore(y,m)}},t.prototype.RenderText=function(t,e,r,a,i){var n=D("text",{x:a.x,y:a.y,class:i},e);switch(r){case"right":n.style.textAnchor="end";break;case"center":n.style.textAnchor="middle";break;default:n.style.textAnchor="start"}(t||this.group).appendChild(n)},t.prototype.RenderDonut=function(t,e,r,a,i,n,o){var s=-Math.PI/2,h=0;n&&(r*=.8,a*=.7);for(var l=function(t,e,r){return[Math.cos(r)*e+t.x,Math.sin(r)*e+t.y]},c=function(t){var n=t.title||"",c=t.percent,d=t.index,p=[],m=0,f=l.bind(0,e,r),_=l.bind(0,e,a);if(c>.5){m=s+c/2*Math.PI*2,h=s+c*Math.PI*2;var g=m-s,v=h-m;p.push("M"+f(s),"A"+r+","+r+","+g+",0,1,"+f(m),"A"+r+","+r+","+v+",0,1,"+f(h),"L"+_(h),"A"+a+","+a+","+v+",0,0,"+_(m),"A"+a+","+a+","+g+",0,0,"+_(s),"Z")}else{m=((h=s+c*Math.PI*2)-s)/2+s;var y=h-s;p.push("M"+f(s),"A"+r+","+r+","+y+",0,1,"+f(h),"L"+_(h),"A"+a+","+a+","+y+",0,0,"+_(s),"Z")}var x=D("path",{d:p,class:void 0===d?void 0:"series-"+d});void 0!==d&&x.setAttribute("data-index",d.toString());var b=D("g",{class:o});if(b.appendChild(x),u.group.appendChild(b),c>=.05&&n){p=[];var w=l(e,a+(r-a)/2+(r-a),m);p.push("M"+l(e,a+(r-a)/2,m)),p.push("L"+w),b.appendChild(D("path",{d:p,class:"callout"}));var C=[],M=D("text",{class:"callout-label"});b.appendChild(M);var S=m+Math.PI/2,A=n;M.textContent=A;var k=M.getBoundingClientRect(),P={width:k.width,height:k.height},T=w[0],R=w[1];T+=P.height/2*Math.cos(m),R+=P.height/4+P.height/2*Math.sin(m);var F=!1;S>Math.PI?T-P.width<=i.left&&(F=!0):T+P.width>i.right&&(F=!0);var z=/[\s-]/;if(F&&z.test(A)){for(var j=-1,N=1,O=0;O<A.length;O++)if(z.test(A[O])){var E=Math.abs(.5-O/A.length);E<N&&(N=E,j=O)}j>0&&(C.push(A.substr(0,j+1).trim()),C.push(A.substr(j+1).trim()))}if(C.length){var U=0,G=0,B=C.map((function(t){M.textContent=t;var e={width:(k=M.getBoundingClientRect()).width,height:k.height};return G=Math.max(G,e.width),{text:t,metrics:e}}));M.textContent="";for(var I=0,J=B;I<J.length;I++){var H=J[I],V=document.createElementNS(L,"tspan");V.textContent=H.text;var Z=S>Math.PI?T-(G-H.metrics.width)/2:T+(G-H.metrics.width)/2;V.setAttribute("x",Z.toString()),V.setAttribute("dy",U.toString()),M.appendChild(V),U=H.metrics.height}}var $=S>Math.PI?"end":"start";M.setAttribute("text-anchor",$),M.setAttribute("x",T.toString()),M.setAttribute("y",R.toString()),void 0!==d&&M.setAttribute("data-index",d.toString())}s=h},u=this,d=0,p=t;d<p.length;d++)c(p[d])},t}(),z=1e3,j=(function(){function t(t,e){void 0===t&&(t=!1),this.verbose=t,this.log_id=e,this.queue=[],this.dispatched=!1,this.subscribers=[]}t.prototype.Publish=function(t){var e,r=this;this.verbose&&console.info("es publish ("+this.log_id+")",t),Array.isArray(t)?(e=this.queue).push.apply(e,t):this.queue.push(t),this.dispatched||(this.dispatched=!0,Promise.resolve().then((function(){var t=r.queue.slice(0);r.dispatched=!1,r.queue=[];for(var e=0,a=t;e<a.length;e++)for(var i=a[e],n=0,o=r.subscribers;n<o.length;n++)o[n].subscriber(i)})))},t.prototype.Subscribe=function(t){var e=z++;return this.subscribers.push({subscriber:t,token:e}),e},t.prototype.Cancel=function(t){this.subscribers=this.subscribers.filter((function(e){return e.token!==t}))},t.prototype.CancelAll=function(){this.subscribers=[]}}(),function(){function t(e,r,a,i){void 0===i&&(i=e),t.Create({container:e,node:r,resize_callback:a,layout_reference:i})}t.Create=function(e){var r,a,i=document.createElement("div");if(i.classList.add("treb-embed-resize-handle"),(e.layout_reference||e.container).appendChild(i),!t.resize_mask){var n=document.querySelector(".treb-embed-mouse-mask");n||((n=document.createElement("div")).classList.add("treb-embed-mouse-mask"),document.body.appendChild(n)),t.resize_mask=n}if(!t.resize_rect){var o=document.querySelector(".treb-embed-resize-rect");o||((o=document.createElement("div")).classList.add("treb-embed-resize-rect"),t.resize_mask.appendChild(o)),t.resize_rect=o}var s={width:0,height:0},h={x:0,y:0},l={x:0,y:0},c=function(){if(t.resize_mask.removeEventListener("mousemove",a),t.resize_mask.removeEventListener("mouseup",r),t.resize_mask.style.display="none",l.x||l.y){var i=e.container.getBoundingClientRect(),n=i.width+l.x,o=i.height+l.y;e.container.style.width=n+"px",e.container.style.height=o+"px",e.resize_callback&&e.resize_callback()}};a=function(e){e.buttons?(l.x!==e.clientX-h.x&&(l.x=e.clientX-h.x,t.resize_rect.style.width=s.width+l.x+4+"px"),l.y!==e.clientY-h.y&&(l.y=e.clientY-h.y,t.resize_rect.style.height=s.height+l.y+4+"px")):c()},r=function(){c()},i.addEventListener("mousedown",(function(i){i.stopPropagation(),i.preventDefault();var n=e.node.getBoundingClientRect();s={width:n.width,height:n.height},t.resize_rect&&(t.resize_rect.style.top=n.top-2+"px",t.resize_rect.style.left=n.left-2+"px",t.resize_rect.style.width=n.width+4+"px",t.resize_rect.style.height=n.height+4+"px"),h={x:i.clientX,y:i.clientY},l={x:0,y:0},t.resize_mask.style.display="block",t.resize_mask.addEventListener("mousemove",a),t.resize_mask.addEventListener("mouseup",r)}))}}(),function(){function t(){}t.MeasureColorARGB=function(t){for(var e=this.MeasureColor(t),r="FF",a=0;a<3;a++){var i=e[a].toString(16);0===i.length?r+="00":1===i.length?r+="0"+i:r+=i}return r.toUpperCase()},t.MeasureColor=function(t){var e=this.color_cache[t];if(e)return e;this.color_measurement_canvas||(this.color_measurement_canvas=document.createElement("canvas"),this.color_measurement_canvas.width=1,this.color_measurement_canvas.height=1);var r=this.color_measurement_canvas.getContext("2d");return r?(r.fillStyle="#fff",r.fillRect(0,0,1,1),r.fillStyle=t,r.fillRect(0,0,1,1),e=r.getImageData(0,0,1,1).data,this.color_cache[t]=e,e):new Uint8ClampedArray(3)},t.EnsureMeasurementNode=function(){if(!this.text_measurement_node){var t=document.querySelector(".treb-chart-measurement-node");t?this.text_measurement_node=t:(this.text_measurement_node=document.createElement("div"),this.text_measurement_node.classList.add("treb-chart-measurement-node"),this.text_measurement_node.style.margin="0px",this.text_measurement_node.style.padding="0px",this.text_measurement_node.style.whiteSpace="nowrap",this.text_measurement_node.style.position="fixed",this.text_measurement_node.style.border="0px",this.text_measurement_node.style.border="1px solid red",this.text_measurement_node.style.boxSizing="content-box",this.text_measurement_node.style.top=this.text_measurement_node.style.left="-1000px",document.body.appendChild(this.text_measurement_node))}},t.FontLoaded=function(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=400);var a=(e?"italic":"")+" "+r+" 20pt "+t,i=this.MeasureText(a+", sans-serif","check font"),n=this.MeasureText(a+", serif","check font"),o=this.MeasureText(a+", monospace","check font");return i.width===n.width&&n.width===o.width},t.MeasureText=function(t,e,r){void 0===r&&(r=0),this.EnsureMeasurementNode(),this.text_measurement_node.style.font=t,/\n/.test(e)?(e=e.replace(/\n/g,"<BR/>"),this.text_measurement_node.innerHTML=e):this.text_measurement_node.textContent=e,this.text_measurement_node.style.lineHeight="1em",this.text_measurement_node.style.transform=r?"rotate("+r+"deg)":"";var a=this.text_measurement_node.getBoundingClientRect();return{width:a.width,height:a.height}},t.color_cache={}}(),function(t,e,r,a,i){if(void 0===r&&(r=6.5),void 0===a&&(a=!1),void 0===i&&(i=!1),e===t)e++,t&&t--;else{var n=Math.round(1e5*e)/1e5;Math.abs(n-e)/(e-t)<1e-5&&(e=n)}var o=e-t,s=Math.log(o)/Math.log(10),h=Math.floor(Math.abs(s))*(s<0?-1:1)-1;i&&(h=Math.max(0,h));for(var l=-1,c=0,u=0,d=i?[1,2,5,10,15,20,25,50,100]:[.1,.25,.5,1,2.5,5,10,25,50,100];u<d.length;u++){var p=d[u]*Math.pow(10,h),m=Math.floor(t/p)*p,f=(Math.ceil(e/p)*p-m)/p,_=Math.abs(f-r);(l<0||_<c)&&(!a||f<=r)&&(c=_,l=p)}return t=Math.floor(t/l)*l,e=Math.ceil(e/l)*l,{scale:h,step:l,count:r=Math.round((e-t)/l),min:t,max:e}}),N=function(){function t(){}return t.Scale=function(t,e,r){return void 0===r&&(r=6.5),j(t,e,r)},t.Range=function(t){for(var e,r,a=0,i=t;a<i.length;a++){var n=i[a];void 0!==n&&((void 0===e||e>n)&&(e=n),(void 0===r||r<n)&&(r=n))}return{min:e,max:r,range:void 0===e||void 0===r?0:r-e}},t.ApplyScale=function(t,e,r){return e*(t-r.min)/(r.max-r.min)},t.Flatten=function(t){var e=[];if(Array.isArray(t))for(var r=0,a=t;r<a.length;r++){var i=a[r];Array.isArray(i)?e=e.concat(this.Flatten(i)):e.push(i)}else void 0!==t&&e.push(t);return e},t}();r(548);var O="#,##0.00",E=function(){function e(t){void 0===t&&(t=new F),this.renderer=t,this.chart_data={type:"null"},this.margin={top:.025,left:.05,bottom:.025,right:.075}}return e.prototype.Initialize=function(t){this.renderer.Initialize(t)},e.prototype.Exec=function(t,e){var r=(null==e?void 0:e.value)||[];switch(t.toLowerCase()){case"mc.histogram":this.CreateHistogram(r);break;case"mc.correlation":this.CreateScatter(r);break;case"column.chart":this.CreateColumnChart(r,"column");break;case"bar.chart":this.CreateColumnChart(r,"bar");break;case"line.chart":this.CreateLineChart(r,"line");break;case"area.chart":this.CreateLineChart(r,"area");break;case"donut.chart":case"pie.chart":this.CreateDonut(r,"pie.chart"===t.toLowerCase());break;case"scatter.plot":this.CreateScatterChart(r,"plot");break;case"scatter.line":this.CreateScatterChart(r,"line");break;default:this.Clear()}},e.prototype.Clear=function(){this.chart_data={type:"null"}},e.prototype.CreateColumnChart=function(e,r){var a,i,n,o=this.TransformSeriesData(e[0]),s=this.CommonData(o);if(e[1]){n=(e[1].type===t.array?N.Flatten(e[1].value):N.Flatten(e[1])).map((function(e){return e?e.type===t.object&&"metadata"===e.value.type?"number"==typeof e.value.value?M.Get(e.value.format||O).Format(e.value.value):e.value.value:"number"==typeof e.value?M.Get(e.format||O).Format(e.value):e.value:""}));var h=o.reduce((function(t,e){return Math.max(t,e.y.data.length)}),0);for(h<n.length&&(n=n.slice(0,h));h>n.length;)n.push("")}var l=(null===(a=e[2])||void 0===a?void 0:a.toString())||void 0,c=(null===(i=e[3])||void 0===i?void 0:i.toString())||void 0;if(this.chart_data={type:r,legend:s.legend,legend_style:k.marker,series2:o,scale:s.y.scale,title:l,y_labels:"bar"===r?n:s.y.labels,x_labels:"bar"===r?s.y.labels:n},c){this.chart_data.round=/round/i.test(c),this.chart_data.data_labels=/labels/i.test(c);var u=c.match(/labels="(.*?)"/);u&&o&&this.ApplyLabels(o,u[1],n)}},e.prototype.ReadSeries=function(e){var r,a,i,n,o={x:{data:[]},y:{data:[]}};if(e[0]&&("object"==typeof(s=N.Flatten(e[0]))[0]?o.label=(null===(a=null===(r=s[0])||void 0===r?void 0:r.value)||void 0===a?void 0:a.toString())||"":o.label=s[0].toString()),e[2]&&"object"==typeof e[2]&&e[2].type===t.array){var s=N.Flatten(e[2].value);if(o.y.data=s.map((function(t){return"number"==typeof t.value.value?t.value.value:void 0})),null===(i=s[0].value)||void 0===i?void 0:i.format){o.y.format=null===(n=s[0].value)||void 0===n?void 0:n.format;var h=M.Get(o.y.format);o.y.labels=o.y.data.map((function(t){return void 0===t?void 0:h.Format(t)}))}}e[1]&&"object"==typeof e[1]&&e[1].type===t.array&&(s=N.Flatten(e[1].value),o.x.data=s.map((function(t){return"number"==typeof t.value.value?t.value.value:void 0})),s[0].value.format&&(o.x.format=s[0].value.format));for(var l=0,c=[o.x,o.y];l<c.length;l++){var u=c[l];if(u.data.length){var d=u.data.filter((function(t){return t||0===t}));u.range={min:Math.min.apply(0,d),max:Math.max.apply(0,d)}}}return o},e.prototype.ArrayToSeries=function(t){var e={x:{data:[]},y:{data:[]}},r=N.Flatten(t.value);if(e.y.data=r.map((function(t,r){return"number"==typeof t.value?t.value:"number"==typeof t.value.value.real?(e.x.data[r]=t.value.value.real,t.value.value.imaginary):"number"==typeof t.value.value?t.value.value:void 0})),r[0].value.format){e.y.format=r[0].value.format||"";var a=M.Get(e.y.format||"");e.y.labels=e.y.data.map((function(t){return void 0===t?void 0:a.Format(t)}))}var i=e.y.data.filter((function(t){return t||0===t}));if(e.y.range={min:Math.min.apply(0,i),max:Math.max.apply(0,i)},e.x.data.length){var n=e.x.data.filter((function(t){return"number"==typeof t}));if(e.x.range={min:Math.min.apply(0,n),max:Math.max.apply(0,n)},r[0].value.format){e.x.format=r[0].value.format||"";var o=M.Get(e.x.format||"");e.x.labels=e.x.data.map((function(t){return void 0===t?void 0:o.Format(t)}))}}return e},e.prototype.TransformSeriesData=function(e,r){if(!e)return[];var a,i=[];if(e.type===t.object)if("group"===e.key){if(Array.isArray(e.value))for(var n=0,o=e.value;n<o.length;n++)if((f=o[n])&&"object"==typeof f)if("series"===f.key){var s=this.ReadSeries(f.value);i.push(s)}else f.type===t.array&&i.push(this.ArrayToSeries(f))}else"series"===e.key&&(s=this.ReadSeries(e.value),i.push(s));else e.type===t.array&&i.push(this.ArrayToSeries(e));var h=0;if((null==r?void 0:r.type)===t.array){var l=N.Flatten(r.value),c="0.00###";l[0]&&l[0].type===t.object&&(c=l[0].value.format);var u=l.map((function(e){return e.type===t.number?e.value:e.type===t.object?e.value.value:void 0})),d=u.filter((function(t){return"number"==typeof t}));a={data:u,format:c,range:{min:Math.min.apply(0,d),max:Math.max.apply(0,d)}}}for(var p=0,m=i;p<m.length;p++){var f=m[p];h=Math.max(h,f.y.data.length),f.x.data.length&&(a||(a=f.x))}if(!a){a={data:[],range:{min:0,max:Math.max(0,h-1)}};for(var _=0;_<h;_++)a.data.push(_)}for(var g=0,v=i;g<v.length;g++)(f=v[g]).x.data.length||(f.x=a);return i},e.prototype.CommonData=function(t,e,r){for(var a,i="",n="",o=0,s=t;o<s.length;o++){var h=s[o];h.y.format&&!n&&(n=h.y.format),h.x.format&&!i&&(i=h.x.format)}t.some((function(t){return t.label&&t.label.length>0}))&&(a=t.map((function(t,e){return t.label||"Series "+(e+1)})));var l=t.filter((function(t){return t.x.range})),c=Math.min.apply(0,l.map((function(t){var e;return(null===(e=t.x.range)||void 0===e?void 0:e.min)||0}))),u=Math.max.apply(0,l.map((function(t){var e;return(null===(e=t.x.range)||void 0===e?void 0:e.max)||0}))),d=(t.filter((function(t){return t.y.range})),Math.min.apply(0,l.map((function(t){var e;return(null===(e=t.y.range)||void 0===e?void 0:e.min)||0})))),p=Math.max.apply(0,l.map((function(t){var e;return(null===(e=t.y.range)||void 0===e?void 0:e.max)||0})));void 0!==e&&(d=Math.min(d,e)),void 0!==r&&(p=Math.max(p,r));var m,f,_=N.Scale(c,u,7),g=N.Scale(d,p,7);if(i){m=[];for(var v=M.Get(i),y=0;y<=_.count;y++)m.push(v.Format(_.min+y*_.step))}if(n)for(f=[],v=M.Get(n),y=0;y<=g.count;y++)f.push(v.Format(g.min+y*g.step));return{x:{format:i,scale:_,labels:m},y:{format:n,scale:g,labels:f},legend:a}},e.prototype.CreateScatterChart=function(t,e){var r,a;void 0===e&&(e="plot");var i=this.TransformSeriesData(t[0]),n=this.CommonData(i),o=(null===(r=t[1])||void 0===r?void 0:r.toString())||void 0,s=(null===(a=t[2])||void 0===a?void 0:a.toString())||void 0;if(this.chart_data={legend:n.legend,style:e,type:"scatter2",series:i,title:o,x_scale:n.x.scale,x_labels:n.x.labels,y_scale:n.y.scale,y_labels:n.y.labels,lines:"line"===e,points:"plot"===e},s){this.chart_data.markers=/marker/i.test(s),this.chart_data.smooth=/smooth/i.test(s),this.chart_data.data_labels=/labels/i.test(s);var h=s.match(/labels="(.*?)"/);h&&this.chart_data.series&&this.ApplyLabels(this.chart_data.series,h[1])}},e.prototype.ApplyLabels=function(t,e,r){for(var a=0,i=t;a<i.length;a++){var n=i[a],o={x:M.Get(n.x.format||""),y:M.Get(n.y.format||"")};n.y.labels=[];for(var s=0;s<n.y.data.length;s++){var h=r?r[s]:"number"==typeof n.x.data[s]?o.x.Format(n.x.data[s]):"",l="number"==typeof n.y.data[s]?o.y.Format(n.y.data[s]):"";n.y.labels[s]=e.replace(/\bx\b/g,h).replace(/\by\b/g,l)}}},e.prototype.CreateLineChart=function(t,e){var r,a,i=this.TransformSeriesData(t[0],t[1]),n=this.CommonData(i,0,0),o=(null===(r=t[2])||void 0===r?void 0:r.toString())||void 0,s=(null===(a=t[3])||void 0===a?void 0:a.toString())||void 0;this.chart_data={legend:n.legend,type:"scatter2",series:i,title:o,x_scale:n.x.scale,x_labels:n.x.labels,y_scale:n.y.scale,y_labels:n.y.labels,lines:!0,filled:"area"===e},s&&(this.chart_data.smooth=/smooth/i.test(s))},e.prototype.CreateDonut=function(e,r){var a,i;void 0===r&&(r=!1);var n=(null===(a=e[0])||void 0===a?void 0:a.type)===t.array?e[0].value:e[0],o=N.Flatten(n),s=o.map((function(t){return"number"==typeof t.value.value?t.value.value:void 0})),h=(null===(i=e[1])||void 0===i?void 0:i.type)===t.array?e[1].value:e[1],l=N.Flatten(h).map((function(t){var e,r,a;if(t&&"object"==typeof t){var i=null===(e=t.value)||void 0===e?void 0:e.value;return"number"==typeof i&&(null===(r=t.value)||void 0===r?void 0:r.format)?M.Get(null===(a=t.value)||void 0===a?void 0:a.format).Format(i):i?i.toString():""}return t?t.toString():""}));s=s.map((function(t){return t<0?(console.warn("pie/donut chart does not support negative values (omitted)"),0):t}));var c=e[2]||"",u=0,d=s.map((function(t,e){return void 0!==t&&(u+=t),{value:t,label:l[e]||"",index:e+1,percent:0}}));if(u)for(var p=0,m=d;p<m.length;p++)(b=m[p]).percent=(b.value||0)/u;var f=o.length&&o[0].format?o[0].format:"",_=M.Get(f||O),g=M.Get("percent");void 0===e[4]&&e[1]&&(e[4]="label");var v=e[4]||"";if(v)for(var y=0,x=d;y<x.length;y++){var b=x[y],w=_.Format(b.value||0),C=g.Format(b.percent);b.title=v.replace(/value%/gi,g.Format(b.value||0)).replace(/value/gi,w).replace(/percent/gi,C).replace(/label/gi,b.label||"").trim()}var S=(e[3]||"").toString().trim();/^(asc|inc)/i.test(S)?d.sort((function(t,e){return(t.value||0)-(e.value||0)})):/^(desc|dec)/i.test(S)&&d.sort((function(t,e){return(e.value||0)-(t.value||0)})),this.chart_data={type:r?"pie":"donut",slices:d,title:c}},e.prototype.CreateScatter=function(e){var r=[e[0],e[1]];if(!r[0]||r[0].type!==t.object||!this.IsCellData(r[0].value))return console.warn("invalid args [0]",e),void this.Clear();if(!r[1]||r[1].type!==t.object||!this.IsCellData(r[1].value))return console.warn("invalid args [1]",e),void this.Clear();var a=e[2]||"",i=r[0].value,n=r[1].value,o=(i.simulation_data||[]).slice(0),s=(n.simulation_data||[]).slice(0),h=Math.min.apply(0,o),l=Math.max.apply(0,o)-h;o=o.map((function(t){return(t-h)/l}));var c=Math.min.apply(0,s),u=Math.max.apply(0,s)-c;s=s.map((function(t){return(t-c)/u}));var d=Math.min(o.length,s.length);this.chart_data={type:"scatter",x:o,y:s,count:d,title:a}},e.prototype.CreateHistogram=function(e){for(var r,a,i=[],n=[],o=Array.isArray(e[0])?e[0]:[e[0]],s=0,h=o;s<h.length;s++){var l=h[s];if(!l||l.type!==t.object||!this.IsCellData(l.value))return console.warn("invalid args [0]",e),void this.Clear();var c=l.value.simulation_data||[];c.length&&(i.push(Math.min.apply(0,c)),n.push(Math.max.apply(0,c)))}if(!i.length||!n.length)return console.info("no data"),void this.Clear();var u=12;"number"==typeof e[3]&&(u=e[3]);for(var d=N.Scale(Math.min.apply(0,i),Math.max.apply(0,n),u),p=[],m=0;m<=d.count;m++)p[m]=d.min+m*d.step;var f=o.map((function(t){for(var e=t.value.simulation_data||[],r=[],a=0;a<=d.count;a++)r[a]=0;for(var i=0,n=e;i<n.length;i++){var o=n[i];r[Math.round((o-d.min)/d.step)]++}var s=M.Get("#,##0"),h=r.filter((function(t){return t||0===t})),l={y:{data:r,format:"#,##0",labels:r.map((function(t){return void 0===t?void 0:s.Format(t)})),range:{min:Math.min.apply(0,h),max:Math.max.apply(0,h)}},x:{data:[],range:{min:0,max:Math.max(0,r.length-1)}}};for(a=0;a<l.y.data.length;a++)l.x.data.push(a);return l})),_=this.CommonData(f),g=M.Get((null===(r=o[0].value)||void 0===r?void 0:r.format)||"General"),v=p.map((function(t){return g.Format(t)})),y=(null===(a=e[1])||void 0===a?void 0:a.toString())||void 0;f[0].y.labels=(f[0].y.labels||[]).map((function(t,e){return v[e]+" "+t})),this.chart_data={type:"column",series2:f,scale:_.y.scale,title:y,y_labels:_.y.labels,x_labels:v,data_labels:!0}},e.prototype.Resize=function(){this.renderer.Resize()},e.prototype.Update=function(){var t=this;this.renderer.Resize(),this.renderer.Prerender(),this.renderer.Clear();var e=new R(0,0,this.renderer.size.width,this.renderer.size.height),r={top:Math.round(e.height)*this.margin.top,bottom:Math.round(e.height)*this.margin.bottom,left:Math.round(e.width)*this.margin.left,right:Math.round(e.width)*this.margin.right},a=this.chart_data.title;if(a&&this.renderer.RenderTitle(a,e,r.top,this.chart_data.title_layout||"top"),e.top+=r.top,e.left+=r.left,e.bottom-=r.bottom,e.right-=r.right,this.chart_data.legend&&this.chart_data.legend.length){var i=A.top;this.chart_data.title&&(this.chart_data.title_layout&&"top"!==this.chart_data.title_layout||(i=A.bottom));var n=this.chart_data.legend_position||i;this.renderer.Legend({labels:this.chart_data.legend,position:n,style:this.chart_data.legend_style,layout:n===A.top||n===A.bottom?S.horizontal:S.vertical,area:e})}if("histogram"===this.chart_data.type||"line"===this.chart_data.type||"area"===this.chart_data.type||"column"===this.chart_data.type||"histogram2"===this.chart_data.type||"bar"===this.chart_data.type||"scatter2"===this.chart_data.type){var o=[],s=0;if(this.chart_data.x_labels&&this.chart_data.x_labels.length&&(o=this.chart_data.x_labels.map((function(e){var r=t.renderer.MeasureText(e,["axis-label","x-axis-label"],!0);return s=Math.max(s,r.height),r}))),this.chart_data.y_labels&&this.chart_data.y_labels.length){for(var h=[],l=0,c=0,u="scatter2"===this.chart_data.type?this.chart_data.y_scale:this.chart_data.scale,d="bar"===this.chart_data.type?this.chart_data.y_labels.length:u.count+1,p=0;p<d;p++){var m=this.renderer.MeasureText(this.chart_data.y_labels[p],["axis-label","y-axis-label"]);h.push({label:this.chart_data.y_labels[p],metrics:m}),l=Math.max(l,m.width),c=Math.max(c,m.height)}e.bottom=Math.round(e.bottom-c/2),e.top=Math.round(e.top+c/2),o.length&&(e.bottom-=s+r.bottom),"bar"===this.chart_data.type?this.renderer.RenderYAxisBar(e,e.left+l,h,["axis-label","y-axis-label"]):this.renderer.RenderYAxis(e,e.left+l,h,["axis-label","y-axis-label"]),e.left+=l+r.left}if(o.length&&this.chart_data.x_labels&&this.chart_data.x_labels.length){var f="histogram2"===this.chart_data.type,_="line"!==this.chart_data.type&&"area"!==this.chart_data.type&&"bar"!==this.chart_data.type&&"scatter2"!==this.chart_data.type&&"histogram2"!==this.chart_data.type;f&&this.renderer.RenderXAxisTicks(e,_,this.chart_data.x_labels.length),this.chart_data.y_labels&&(e.bottom+=s+r.bottom),this.renderer.RenderXAxis(e,_,this.chart_data.x_labels,o,["axis-label","x-axis-label"]),e.bottom-=s+r.bottom}}switch(this.chart_data.type){case"scatter":this.renderer.RenderPoints(e,this.chart_data.x,this.chart_data.y,"mc mc-correlation series-1");break;case"scatter2":if(this.renderer.RenderGrid(e,this.chart_data.y_scale.count,this.chart_data.x_scale.count+1,"chart-grid"),this.chart_data.series){for(p=0;p<this.chart_data.series.length;p++){var g=this.chart_data.series[p];this.renderer.RenderScatterSeries(e,g.x.data,g.y.data,this.chart_data.x_scale,this.chart_data.y_scale,!!this.chart_data.lines,!!this.chart_data.points,!!this.chart_data.filled,!!this.chart_data.markers,!!this.chart_data.smooth,"scatter-plot series-"+(p+1))}if(this.chart_data.data_labels)for(p=0;p<this.chart_data.series.length;p++)(g=this.chart_data.series[p]).y.labels&&this.renderer.RenderDataLabels(e,g.x.data,g.y.data,this.chart_data.x_scale,this.chart_data.y_scale,g.y.labels,p+1)}break;case"pie":case"donut":var v=Math.min(e.height,e.width)/2*.9,y="pie"===this.chart_data.type?0:.8*v;this.renderer.RenderDonut(this.chart_data.slices,e.center,v,y,e,!0,"donut");break;case"line":case"area":var x=this.chart_data.scale;if(this.chart_data.series){var b=this.chart_data.x_scale?this.chart_data.x_scale.max:Math.max.apply(0,this.chart_data.series.map((function(t){return t.length}))),w=this.chart_data.smooth?this.renderer.RenderSmoothLine:this.renderer.RenderLine;this.renderer.RenderGrid(e,this.chart_data.scale.count,this.chart_data.x_scale?this.chart_data.x_scale.count+1:b,"chart-grid");for(var C=0,M=0,k=this.chart_data.series;M<k.length;M++){if((B=(g=k[M]).map((function(t){if(void 0!==t)return N.ApplyScale(t,e.height,x)}))).length<b)for(p=B.length;p<b;p++)B.push(void 0);var P=["area"===this.chart_data.type?"chart-area":"chart-line","series-"+(C+1)];w.call(this.renderer,e,B,"area"===this.chart_data.type,this.chart_data.titles,P),C++}}break;case"bar":var T=void 0;if(this.renderer.RenderBarGrid(e,this.chart_data.scale.count,"chart-grid"),this.chart_data.series2){d=0;for(var L=this.chart_data.series2.length,D=0,F=this.chart_data.series2;D<F.length;D++)g=F[D],d=Math.max(d,g.y.data.length);var z=e.height/d,j=.7;"number"==typeof this.chart_data.space&&(j=Math.max(0,Math.min(1,1-this.chart_data.space)));var O=(z-2*(et=z*(1-j)/2))/L,E=0;if(this.chart_data.scale.min<0&&(E=N.ApplyScale(0,e.width,this.chart_data.scale)),this.chart_data.round){var U=Math.floor(O/2);T=[0,U,U,0]}for(var G=0;G<L;G++)for(g=this.chart_data.series2[G],p=0;p<g.y.data.length;p++)if("number"==typeof(K=g.y.data[p])){var B=Math.round(e.top+p*z+et)+G*O,I=0,J=0;E?K>0?(J=N.ApplyScale(K+this.chart_data.scale.min,e.width,this.chart_data.scale),I=e.left+E):(J=N.ApplyScale(this.chart_data.scale.min-K,e.width,this.chart_data.scale),I=e.left+E-J):(J=N.ApplyScale(K,e.width,this.chart_data.scale),I=e.left);var H=void 0;J&&this.renderer.RenderRectangle(new R(I,B,I+J,B+O),T,["chart-column","series-"+(G+1)],H||void 0)}}break;case"column":case"histogram2":if(this.renderer.RenderGrid(e,this.chart_data.scale.count,0,"chart-grid"),this.chart_data.series2){d=0,L=this.chart_data.series2.length;for(var V=0,Z=this.chart_data.series2;V<Z.length;V++)g=Z[V],d=Math.max(d,g.y.data.length);var $=e.width/d,Y=.7;if("number"==typeof this.chart_data.space&&(Y=Math.max(0,Math.min(1,1-this.chart_data.space))),J=($-2*(et=$*(1-Y)/2))/L,E=0,this.chart_data.scale.min<0&&(E=N.ApplyScale(0,e.height,this.chart_data.scale)),this.chart_data.callouts&&this.chart_data.x_scale){var q=this.chart_data.x_scale,X=this.chart_data.callouts.map((function(t,r){var a=Math.round(e.left+N.ApplyScale(t.value,e.width,q))+.5;return{x1:a,y1:e.bottom-e.height,x2:a,y2:e.bottom,classes:"callout-"+(r+1)}}));this.renderer.RenderCalloutLines(X)}if(T=void 0,this.chart_data.round){var W=Math.floor(J/2);T=[W,W,0,0]}for(G=0;G<L;G++)for(g=this.chart_data.series2[G],p=0;p<g.y.data.length;p++){var K;if("number"==typeof(K=g.y.data[p])&&(I=e.left+p*$+et+G*J,O=0,B=0,E?K>0?(O=N.ApplyScale(K+this.chart_data.scale.min,e.height,this.chart_data.scale),B=e.bottom-O-E):(O=N.ApplyScale(this.chart_data.scale.min-K,e.height,this.chart_data.scale),B=e.bottom-E):(O=N.ApplyScale(K,e.height,this.chart_data.scale),B=e.bottom-O),H=void 0,O)){var Q=this.chart_data.data_labels&&g.y.labels?g.y.labels[p]:"",tt={x:Math.round(I+J/2),y:Math.round(B-10)};this.renderer.RenderRectangle(new R(I,B,I+J,B+O),T,["chart-column","series-"+(G+1)],H||void 0,Q,tt)}}}break;case"histogram":this.renderer.RenderGrid(e,this.chart_data.scale.count,0,"chart-grid");var et=($=e.width/this.chart_data.count)*(1-(Y=this.chart_data.column_width))/2;for(p=0;p<this.chart_data.count;p++)I=Math.round(e.left+p*$+et),J=$-2*et,O=N.ApplyScale(this.chart_data.bins[p],e.height,this.chart_data.scale),B=e.bottom-O,H=this.chart_data.titles?this.chart_data.titles[p]:void 0,this.renderer.RenderRectangle(new R(I,B,I+J,B+O),void 0,"chart-column series-1",H||void 0)}},e.prototype.IsCellData=function(t){return"object"==typeof t&&"object"==typeof t.address&&"number"==typeof t.address.row&&"number"==typeof t.address.column},e.functions_registered=!1,e}()})();var i=a.xu,n=a.kL,o=a.WH,s=a.y4,h=a.FJ,l=a.Ci,c=a.Zr,u=a.YU;export{i as Box,n as Chart,o as Localization,s as NumberFormat,h as NumberFormatCache,l as Scale,c as Util,u as ValueParser};